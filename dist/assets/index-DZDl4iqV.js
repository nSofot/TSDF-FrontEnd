import{j as e,r as t,u as ee,a as be,b as y,L as j,F as Me,c as Re,d as Ze,V as m,R as Le,e as q,N as Qe,G as Ie,f as Ge,g as et,h as tt,i as st,M as at,k as rt,B as Ee,l as Oe,m as Ue,n as de,o as lt,p as nt,q as ot,s as ct,t as it,v as dt,w as xt,x as mt,y as ut,z as $e,A as ht,C as pt,D as gt,O as Be,E as _e,H as qe,I as ft,J as bt,K as jt,P as yt}from"./vendor-HmYKF1b8.js";(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))i(s);new MutationObserver(s=>{for(const l of s)if(l.type==="childList")for(const d of l.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&i(d)}).observe(document,{childList:!0,subtree:!0});function a(s){const l={};return s.integrity&&(l.integrity=s.integrity),s.referrerPolicy&&(l.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?l.credentials="include":s.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function i(s){if(s.ep)return;s.ep=!0;const l=a(s);fetch(s.href,l)}})();function ne(){return e.jsx("div",{className:"w-full h-full flex justify-center items-center",children:e.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-4 border-t-blue-900 border-b-blue-900 border-l-blue-900 border-gray-300"})})}function Nt(){const[r,n]=t.useState([]),[a,i]=t.useState(!0),s=ee(),l=be();return localStorage.getItem("token"),t.useEffect(()=>{window.scrollTo(0,0),i(!0),y.get("http://localhost:3000/api/customer").then(d=>{n(d.data),i(!1)})},[l]),e.jsxs("div",{className:"w-full h-full flex flex-col p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"🛍️ Members"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage members"})]}),e.jsx(j,{to:"/admin/add-customer",className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md text-sm font-medium shadow",children:"+ Add New Member"})]}),e.jsx("div",{className:"bg-white shadow rounded-md overflow-x-auto",children:a?e.jsx(ne,{}):e.jsxs("table",{className:"min-w-full text-sm text-left border border-gray-200",children:[e.jsx("thead",{className:"bg-purple-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"#"}),e.jsx("th",{className:"px-4 py-2",children:"Mem/Id"}),e.jsx("th",{className:"px-4 py-2",children:"Name"}),e.jsx("th",{className:"px-4 py-2",children:"Mobile"}),e.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:r.map((d,o)=>e.jsxs("tr",{className:"hover:bg-purple-100 transition duration-150",children:[e.jsx("td",{className:"px-4 py-2",children:o+1}),e.jsx("td",{className:"px-4 py-2 font-medium",children:d.customerId}),e.jsx("td",{className:"px-4 py-2",children:d.name}),e.jsx("td",{className:"px-4 py-2",children:d.mobile}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>deleteProduct(d.productId),className:"text-red-600 hover:text-red-800",children:e.jsx(Me,{className:"text-lg"})}),e.jsx("button",{onClick:()=>s("/admin/edit-customer",{state:{...d}}),className:"text-blue-600 hover:text-blue-800",children:e.jsx(Re,{className:"text-lg"})})]})})]},o))})]})})]})}const wt="https://fqchfixofctbyywmfdnr.supabase.co",vt="eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImZxY2hmaXhvZmN0Ynl5d21mZG5yIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDY2MjUzMTUsImV4cCI6MjA2MjIwMTMxNX0.dNAuRXo8ekU1f97O6M4J4B4QIKpwoXLaIhbdRMYYYTQ",Pe=Ze(wt,vt);async function ze(r){if(!r)throw new Error("No file selected");const a=`${new Date().getTime()}_${r.name}`,{data:i,error:s}=await Pe.storage.from("images").upload(a,r,{upsert:!1,cacheControl:"3600"});if(s)throw new Error("Upload failed: "+s.message);const{data:l,error:d}=Pe.storage.from("images").getPublicUrl(a);if(d||!(l!=null&&l.publicUrl))throw new Error("Failed to get public URL");return l.publicUrl}function St(){const r=ee(),[n,a]=t.useState(""),[i,s]=t.useState(""),[l,d]=t.useState(""),[o,b]=t.useState(""),[x,p]=t.useState([]),[c,S]=t.useState(""),[g,N]=t.useState(""),[u,w]=t.useState(""),v=async()=>{var A,D;const h=localStorage.getItem("token");if(!h)return m.error("Please log in first.");if(!i||!l)return m.error("Please fill in all fields.");try{const f=await Promise.all(x.map(O=>ze(O))),C={customerId:n,name:i,address:l,mobile:o,phone:c,email:g,notes:u};await y.post("http://localhost:3000/api/customer",C,{headers:{Authorization:`Bearer ${h}`}}),m.success("Member added successfully!"),r(-1)}catch(f){m.error(((D=(A=f==null?void 0:f.response)==null?void 0:A.data)==null?void 0:D.message)||"Something went wrong")}};return e.jsxs("div",{className:"w-full h-full flex flex-col p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"🛒 Add New Member"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Fill the member details to add it"})]}),e.jsxs("div",{className:"flex justify-end gap-6",children:[e.jsx("button",{onClick:v,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-lg text-smfont-medium shadow-md transition duration-300",children:"Add Member"}),e.jsx(j,{to:"/admin/member",className:"bg-red-500 hover:bg-red-600 text-white px-8 py-2 rounded-md text-sm font-medium shadow",children:"Cancel"})]})]}),e.jsx("div",{className:"bg-white w-full h-full px-10 py-6 shadow rounded-xl border border-gray-200 flex flex-col",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("div",{className:"w-[55%] h-full space-y-10",children:[e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsxs("div",{className:"w-[20%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Member ID"}),e.jsx("input",{type:"text",value:n,onChange:h=>a(h.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"w-[75%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Member Name"}),e.jsx("input",{type:"text",value:i,onChange:h=>s(h.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. Apple iPhone 15"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address (comma-separated)"}),e.jsx("input",{type:"text",value:l,onChange:h=>d(h.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. No 123, Main Street, Kegalle."})]}),e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsxs("div",{className:"w-[25%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Number"}),e.jsx("input",{type:"text",value:o,onChange:h=>b(h.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 0711234567"})]}),e.jsxs("div",{className:"w-[25%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"text",value:c,onChange:h=>S(h.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 0761234567"})]}),e.jsxs("div",{className:"w-[45%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"text",value:g,onChange:h=>N(h.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 150"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{rows:"3",value:u,onChange:h=>w(h.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Write a notes here..."})]})]}),e.jsxs("div",{className:"w-[40%] h-full rounded-lg flex flex-col justify-between",children:[e.jsx("p",{className:"text-sm text-gray-700 font-medium mb-1",children:"Selected Images"}),e.jsx("div",{className:"w-full h-80 overflow-y-auto bg-white rounded-md shadow-inner",children:x.length>0&&e.jsx("div",{className:"space-y-2",children:e.jsx("div",{className:"grid grid-cols-3 gap-3",children:x.map((h,A)=>e.jsxs("div",{className:"relative border rounded-md overflow-hidden group",children:[e.jsx("img",{src:URL.createObjectURL(h),alt:`new-${A}`,className:"w-full h-20 object-cover"}),e.jsx("button",{type:"button",onClick:()=>{const D=x.filter((f,C)=>C!==A);p(D)},className:"absolute top-1 right-1 bg-black bg-opacity-60 text-white text-xs rounded-full px-2 py-0.5 hover:bg-red-600",children:"✕"})]},`new-${A}`))})})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Upload Images"}),e.jsx("input",{type:"file",multiple:!0,onChange:h=>p(Array.from(h.target.files)),className:"w-full text-sm text-blue-500 font-italic file-input file-input-bordered rounded-lg cursor-pointer hover:text-blue-800"})]})]})]})})]})}function kt(){const r=be(),n=ee(),[a,i]=t.useState(""),[s,l]=t.useState(""),[d,o]=t.useState(""),[b,x]=t.useState(""),[p,c]=t.useState([]),[S,g]=t.useState(""),[N,u]=t.useState(""),[w,v]=t.useState(""),[h,A]=t.useState([]);localStorage.getItem("token"),t.useEffect(()=>{if(r.state){const f=r.state;i(f.customerId||""),l(f.name||""),o(f.address||""),x(f.notes||""),g(f.mobile||""),u(f.phone||""),v(f.email||"")}},[r.state]);async function D(){var C,O;const f=localStorage.getItem("token");if(!f){m.error("Please login first");return}try{let E=[];if(p.length>0){const Z=p.map(me=>ze(me));E=await Promise.all(Z)}const W={customerId:a,name:s,address:d,notes:b,image:[...h,...E],mobile:S,phone:N,email:w};await y.put(`http://localhost:3000/api/customer/${a}`,W,{headers:{Authorization:`Bearer ${f}`,"Content-Type":"application/json"}}),m.success("Member updated successfully"),n(-1)}catch(E){console.error(E),m.error(((O=(C=E==null?void 0:E.response)==null?void 0:C.data)==null?void 0:O.message)||"Update failed")}}return e.jsxs("div",{className:"w-full h-full flex flex-col p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"✏️ Edit Member"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Update existing member information"})]}),e.jsxs("div",{className:"flex justify-end gap-6",children:[e.jsx("button",{onClick:D,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-sm font-medium shadow-md transition duration-300",children:"Update Member"}),e.jsx(j,{to:"/admin/products",className:"bg-red-500 hover:bg-red-600 text-white px-10 py-2 rounded-md text-sm font-medium shadow",children:"Cancel"})]})]}),e.jsx("div",{className:"bg-white w-full h-full px-10 py-6 shadow rounded-xl border border-gray-200 flex flex-col",children:e.jsxs("div",{className:" flex justify-between",children:[e.jsxs("div",{className:"w-[55%] h-full space-y-10",children:[e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsxs("div",{className:"w-[20%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Member ID"}),e.jsx("input",{type:"text",disabled:!0,value:a,className:"w-full p-2 bg-gray-100 text-sm border border-gray-300 rounded-lg text-gray-700 cursor-not-allowed"})]}),e.jsxs("div",{className:"w-[75%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Member Name"}),e.jsx("input",{type:"text",value:s,onChange:f=>l(f.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. Apple iPhone 15"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Address (comma-separated)"}),e.jsx("input",{type:"text",value:d,onChange:f=>o(f.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. iPhone, iPhone 15"})]}),e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsxs("div",{className:"w-[25%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mobile Number"}),e.jsx("input",{type:"text",value:S,onChange:f=>g(f.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 999.99"})]}),e.jsxs("div",{className:"w-[25%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"text",value:N,onChange:f=>u(f.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 899.99"})]}),e.jsxs("div",{className:"w-[45%]",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),e.jsx("input",{type:"text",value:w,onChange:f=>v(f.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"e.g. 150"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{rows:"3",value:b,onChange:f=>x(f.target.value),className:"w-full p-2 text-sm border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Write a detailed description of the product..."})]})]}),e.jsxs("div",{className:"w-[40%] h-full rounded-lg flex flex-col justify-between",children:[e.jsx("p",{className:"text-sm text-gray-700 font-medium mb-1",children:"Existing Images"}),e.jsx("div",{className:"w-full h-80 overflow-y-auto bg-white rounded-md shadow-inner",children:h.length>0&&e.jsx("div",{className:"space-y-2",children:e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[h.map((f,C)=>e.jsxs("div",{className:"relative border rounded-md overflow-hidden group",children:[e.jsx("img",{src:f,alt:`existing-${C}`,className:"w-full h-20 object-cover"}),e.jsx("button",{type:"button",onClick:()=>{const O=h.filter((E,W)=>W!==C);A(O)},className:"absolute top-1 right-1 bg-black bg-opacity-60 text-white text-xs rounded-full px-2 py-0.5 hover:bg-red-600",children:"✕"})]},`existing-${C}`)),p.map((f,C)=>e.jsxs("div",{className:"relative border rounded-md overflow-hidden group",children:[e.jsx("img",{src:URL.createObjectURL(f),alt:`new-${C}`,className:"w-full h-20 object-cover"}),e.jsx("button",{type:"button",onClick:()=>{const O=p.filter((E,W)=>W!==C);c(O)},className:"absolute top-1 right-1 bg-black bg-opacity-60 text-white text-xs rounded-full px-2 py-0.5 hover:bg-red-600",children:"✕"})]},`new-${C}`))]})})}),e.jsxs("div",{className:"mt-8",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Add New Images (optional)"}),e.jsx("input",{type:"file",multiple:!0,onChange:f=>c(Array.from(f.target.files)),className:"w-full text-sm text-blue-500 font-italic file-input file-input-bordered rounded-lg cursor-pointer hover:text-blue-800"})]})]})]})})]})}function It(){const[r,n]=t.useState([]),[a,i]=t.useState(!0),s=ee(),l=be();t.useEffect(()=>{(async()=>{var b,x;try{const p=localStorage.getItem("token");if(!p){m.error("Please login first"),s("/login");return}const c=await y.get("http://localhost:3000/api/user/users",{headers:{Authorization:`Bearer ${p}`}});c.data&&typeof c.data=="object"&&!Array.isArray(c.data)?n([c.data]):Array.isArray(c.data)?n(c.data):(console.error("Unexpected data format",c.data),n([]))}catch(p){console.error("❌ API error",p),m.error(((x=(b=p.response)==null?void 0:b.data)==null?void 0:x.message)||"Failed to fetch users"),n([])}finally{i(!1)}})()},[l,a]);function d(o){const b=localStorage.getItem("token");if(!b){m.error("Please login first");return}y.delete(`http://localhost:3000/api/user/${o}`,{headers:{Authorization:`Bearer ${b}`}}).then(()=>{m.success("User deleted successfully"),n(x=>x.filter(p=>p._id!==o))}).catch(x=>{var p,c;m.error(((c=(p=x.response)==null?void 0:p.data)==null?void 0:c.message)||"Delete failed")})}return e.jsxs("div",{className:"w-full h-full flex flex-col p-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"👤 Users"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage registered users and access levels"})]}),e.jsx(j,{to:"/admin/add-user",className:"bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-md text-sm font-medium shadow",children:"+ Add New User"})]}),e.jsx("div",{className:"bg-white shadow rounded-md overflow-x-auto",children:a?e.jsx(ne,{}):e.jsxs("table",{className:"min-w-full text-sm text-left border border-gray-200",children:[e.jsx("thead",{className:"bg-purple-600 text-white",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"Image"}),e.jsx("th",{className:"px-4 py-2",children:"First Name"}),e.jsx("th",{className:"px-4 py-2",children:"Last Name"}),e.jsx("th",{className:"px-4 py-2",children:"Email"}),e.jsx("th",{className:"px-4 py-2",children:"Role"}),e.jsx("th",{className:"px-4 py-2",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:r.map(o=>e.jsxs("tr",{className:"hover:bg-purple-100 transition duration-150",children:[e.jsx("td",{className:"px-4 py-2",children:e.jsx("img",{src:o.image,alt:`${o.firstName} ${o.lastName}`,className:"w-12 h-12 object-cover rounded-md"})}),e.jsx("td",{className:"px-4 py-2",children:o.firstname}),e.jsx("td",{className:"px-4 py-2",children:o.lastname}),e.jsx("td",{className:"px-4 py-2",children:o.email}),e.jsx("td",{className:"px-4 py-2",children:o.role}),e.jsx("td",{className:"px-4 py-2",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>d(o._id),className:"text-red-600 hover:text-red-800",children:e.jsx(Me,{className:"text-lg"})}),e.jsx("button",{onClick:()=>s("/admin/edit-user",{state:o}),className:"text-blue-600 hover:text-blue-800",children:e.jsx(Re,{className:"text-lg"})})]})})]},o._id))})]})})]})}function Ae(){return e.jsxs("div",{className:"min-h-screen flex flex-col items-center justify-center bg-gray-100",children:[e.jsx("h1",{className:"text-5xl font-bold text-red-600",children:"404"}),e.jsx("p",{className:"text-xl mt-2 text-gray-700",children:"Page Not Found"}),e.jsx(j,{to:"/",className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Go to Home"})]})}function Lt(){const n=be().pathname,a=ee(),[i,s]=t.useState("loading");t.useEffect(()=>{const o=new AbortController,b=localStorage.getItem("token");if(!b){s("unauthenticated"),m.error("Please login"),a("/login",{replace:!0});return}return y.get("http://localhost:3000/api/user/",{headers:{Authorization:`Bearer ${b}`},signal:o.signal}).then(x=>{var c;((c=x.data.role)==null?void 0:c.toLowerCase())!=="admin"?(s("unauthorized"),m.error("Unauthorized access"),a("/",{replace:!0})):s("authenticated")}).catch(x=>{y.isCancel(x)||(s("unauthenticated"),m.error("Session expired. Please login again"),a("/login",{replace:!0}))}),()=>o.abort()},[a]);const l=o=>n.includes(`/admin/${o}`)?"text-white bg-purple-600 px-3 py-2 rounded hover:bg-gray-600 transition":"text-purple-600 px-3 py-2 rounded hover:bg-gray-300 transition",d=()=>{localStorage.removeItem("token"),m.success("Logged out successfully"),a("/login",{replace:!0})};return i==="loading"?e.jsx(ne,{}):e.jsx("div",{className:"w-full h-screen bg-purple-600 flex flex-col font-sans",children:e.jsxs("div",{className:"flex flex-1 overflow-hidden",children:[e.jsxs("aside",{className:"w-[256px] bg-white border-r shadow-md flex flex-col justify-between p-4",children:[e.jsxs("div",{className:"flex flex-col space-y-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-purple-800 mb-4",children:"Admin Panel"}),e.jsx(j,{className:l("members"),to:"/admin/members",children:"📦 Members"}),e.jsx(j,{className:l("users"),to:"/admin/users",children:"👤 Users"}),e.jsx(j,{className:l("add-product"),to:"/admin/add-customer",children:"➕ Add Customer"})]}),e.jsx("button",{onClick:d,className:"mt-6 text-red-600 font-semibold px-3 py-2 rounded hover:bg-red-100 transition text-left",children:"🔓 Logout"})]}),e.jsx("main",{className:"h-full w-[calc(100%-256px)] border-purple-600 border-4 rounded-xl bg-white overflow-y-auto",children:e.jsxs(Le,{children:[e.jsx(q,{index:!0,element:e.jsx(Qe,{to:"members",replace:!0})}),e.jsx(q,{path:"members",element:e.jsx(Nt,{})}),e.jsx(q,{path:"users",element:e.jsx(It,{})}),e.jsx(q,{path:"add-customer",element:e.jsx(St,{})}),e.jsx(q,{path:"edit-customer",element:e.jsx(kt,{})}),e.jsx(q,{path:"*",element:e.jsx(Ae,{})})]})})]})})}function Ct(){const[r,n]=t.useState(!1),a=ee(),i=be(),s=localStorage.getItem("token");localStorage.getItem("cart");const l=!!s,d=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),a("/",{replace:!0})};return t.useEffect(()=>{n(!1)},[i.pathname]),e.jsxs("header",{className:"w-full h-[80px] shadow-2xl flex justify-center relative bg-white z-50",children:[e.jsx(Ie,{className:"h-full text-3xl md:hidden absolute left-4 cursor-pointer",onClick:()=>n(!0)}),e.jsx("img",{src:"/LogoTSDF.png",alt:"Logo",className:"w-[80px] h-[80px] object-cover cursor-pointer",onClick:()=>a("/")}),e.jsxs("nav",{className:"flex-1 hidden md:flex justify-center items-center",children:[e.jsx(j,{to:"/control/",className:"text-lg font-bold mx-3 hover:underline",children:"Home"}),e.jsx(j,{to:"/control/members",className:"text-lg font-bold mx-3 hover:underline",children:"Members"}),e.jsx(j,{to:"/control/apply-loan",className:"text-lg font-bold mx-3 hover:underline",children:"Apply Loan"}),e.jsx(j,{to:"/control/approve-loan",className:"text-lg font-bold mx-3 hover:underline",children:"Approve Loan"}),e.jsx(j,{to:"/control/grant-loan",className:"text-lg font-bold mx-3 hover:underline",children:"Grant Loan"}),e.jsx(j,{to:"/control/receipts-membership",className:"text-lg font-bold mx-3 hover:underline",children:"Receipts-Membership"}),e.jsx(j,{to:"/control/receipts-loan",className:"text-lg font-bold mx-3 hover:underline",children:"Receipts-Loan "}),e.jsx(j,{to:"/control/cash-book",className:"text-lg font-bold mx-3 hover:underline",children:"Cash Book"}),e.jsx(j,{to:"/control/ledger-loan",className:"text-lg font-bold mx-3 hover:underline",children:"Loan Ledger"}),e.jsx(j,{to:"/contact",className:"text-lg font-bold mx-3 hover:underline",children:"Shares"})]}),e.jsxs("div",{className:"w-[50px] hidden md:flex flex-col items-center p-4 mr-4",children:[e.jsx(Ge,{className:"text-2xl cursor-pointer"}),l?e.jsx("button",{onClick:d,className:"text-md font-semibold text-red-600",children:"Logout"}):e.jsx(j,{to:"/login",className:"text-md font-semibold text-blue-600",children:"Login"})]}),e.jsx("div",{className:`fixed inset-0 bg-black/60 md:hidden transition-opacity duration-300 ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>n(!1),children:e.jsxs("aside",{className:`w-[280px] bg-white h-full shadow-xl transform transition-transform duration-300 ${r?"translate-x-0":"-translate-x-full"}`,onClick:o=>o.stopPropagation(),children:[e.jsxs("div",{className:"h-[80px] shadow flex items-center px-4",children:[e.jsx(Ie,{className:"text-3xl cursor-pointer",onClick:()=>n(!1)}),e.jsx("img",{src:"/LogoTSDF.png",alt:"Logo",className:"w-[60px] h-[60px] object-cover ml-auto cursor-pointer",onClick:()=>a("/")})]}),e.jsxs("nav",{className:"flex flex-col items-start px-6 gap-4 mt-6",children:[e.jsx(j,{to:"/control/",className:"text-lg font-bold",onClick:()=>n(!1),children:"Home"}),e.jsx(j,{to:"/control/members",className:"text-lg font-bold",onClick:()=>n(!1),children:"Members"}),e.jsx(j,{to:"/control/apply-loan",className:"text-lg font-bold",onClick:()=>n(!1),children:"Apply Loan"}),e.jsx(j,{to:"/control/approve-loan",className:"text-lg font-bold",onClick:()=>n(!1),children:"Approve Loan"}),e.jsx(j,{to:"/control/grant-loan",className:"text-lg font-bold",onClick:()=>n(!1),children:"Grant Loan"}),e.jsx(j,{to:"/control/receipts-membership",className:"text-lg font-bold",onClick:()=>n(!1),children:"Receipts-Membership"}),e.jsx(j,{to:"/control/receipts-loan",className:"text-lg font-bold",onClick:()=>n(!1),children:"Receipts-Loan "}),e.jsx(j,{to:"/control/cash-book",className:"text-lg font-bold",onClick:()=>n(!1),children:"Cash Book"}),e.jsx(j,{to:"/control/ledger-loan",className:"text-lg font-bold",onClick:()=>n(!1),children:"Loan Ledger"}),e.jsx(j,{to:"/contact",className:"text-lg font-bold",onClick:()=>n(!1),children:"Shares"}),l?e.jsx("button",{onClick:d,className:"text-lg font-bold text-red-600 mt-2",children:"Logout"}):e.jsx(j,{to:"/login",className:"text-lg font-bold text-blue-600 mt-2",children:"Login"})]})]})})]})}function V(r){return Number(r).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})}function At(){localStorage.getItem("token");const[r,n]=t.useState(!0),[a,i]=t.useState([]),[s,l]=t.useState([]),[d,o]=t.useState([]),[b,x]=t.useState([]);return t.useEffect(()=>{(async()=>{try{n(!0);const S=(await y.get("http://localhost:3000/api/customer")).data;i(S);const[g,N]=await Promise.all([y.get("http://localhost:3000/api/loanMaster/approval"),y.get("http://localhost:3000/api/loanMaster/grant")]);l(g.data.map(v=>{var h;return{...v,customerName:((h=S.find(A=>String(A.customerId)===String(v.customerId)))==null?void 0:h.name)||"Unknown"}})),o(N.data.map(v=>{var h;return{...v,customerName:((h=S.find(A=>String(A.customerId)===String(v.customerId)))==null?void 0:h.name)||"Unknown"}}));const w=(await y.get("http://localhost:3000/api/ledgerAccounts")).data.find(v=>v.headerAccountId==="325");x(w)}catch(c){console.error("Fetch error:",c)}finally{n(!1)}})()},[]),r?e.jsx(ne,{}):e.jsxs("div",{className:"max-w-5xl mx-auto min-h-screen bg-gradient-to-br from-orange-50 to-orange-200 flex flex-col",children:[e.jsxs("div",{className:"sticky top-0 z-30 bg-gradient-to-r from-red-500 to-orange-500 text-white shadow-md p-4 rounded-b-xl",children:[e.jsx("h1",{className:"text-xl md:text-2xl font-bold",children:"📊 පාලන පුවරුව"}),e.jsx("p",{className:"text-xs opacity-80",children:"ණය, අනුමැතීන් සහ මුදල් ප්‍රවාහය කළමනාකරණය කිරීමේ පිටුව"})]}),e.jsxs("div",{className:"flex-1 p-4 space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsxs("h2",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx(et,{className:"text-blue-500"})," අනුමැතිය සඳහා පොරොත්තු ණය අයදුම්පත්"]}),s.length>0?e.jsx("div",{className:"mt-3 space-y-3",children:s.map(p=>e.jsxs("div",{className:"p-3 rounded-lg border bg-gradient-to-r from-blue-50 to-blue-100 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:p.customerName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",p.customerId," • ",p.loanType]})]}),e.jsx("span",{className:"text-blue-700 font-semibold",children:V(p.amount)})]},p._id))}):e.jsx("p",{className:"text-gray-400 mt-3 text-sm",children:"No pending approvals"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsxs("h2",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx(tt,{className:"text-green-500"})," නිකුත් කිරීම සඳහා පොරොත්තු ණය"]}),d.length>0?e.jsx("div",{className:"mt-3 space-y-3",children:d.map(p=>e.jsxs("div",{className:"p-3 rounded-lg border bg-gradient-to-r from-green-50 to-green-100 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:p.customerName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["ID: ",p.customerId," • ",p.loanType]})]}),e.jsx("span",{className:"text-green-700 font-semibold",children:V(p.amount)})]},p._id))}):e.jsx("p",{className:"text-gray-400 mt-3 text-sm",children:"No pending loans"})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-md p-4",children:[e.jsxs("h2",{className:"text-sm font-semibold text-gray-700 flex items-center gap-2",children:[e.jsx(st,{className:"text-yellow-500"})," මුදල් පොත්"]}),b?e.jsxs("div",{className:"mt-3 flex justify-between items-center p-3 rounded-lg border bg-gradient-to-r from-yellow-50 to-yellow-100",children:[e.jsx("span",{className:"font-medium text-gray-800",children:b.accountName}),e.jsx("span",{className:"text-yellow-700 font-bold",children:V(b.accountBalance)})]}):e.jsx("p",{className:"text-gray-400 mt-3 text-sm",children:"No cash register found"})]})]})]})}function Dt(){const[r,n]=t.useState([]),[a,i]=t.useState(!0);ee();const s=be(),[l,d]=t.useState(!1),[o,b]=t.useState(null),[x,p]=t.useState("Overview");return localStorage.getItem("token"),t.useEffect(()=>{window.scrollTo(0,0),i(!0),y.get("http://localhost:3000/api/customer").then(c=>{n(c.data),i(!1)})},[s]),e.jsxs("div",{className:"w-full h-full flex flex-col p-4",children:[e.jsx("div",{className:"flex justify-between items-center mb-4",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-semibold text-gray-800",children:"🛍️ Members"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Manage members"})]})}),e.jsx("div",{className:"bg-white shadow rounded-md overflow-hidden",children:a?e.jsx(ne,{}):e.jsx("div",{className:"overflow-y-auto max-h-[500px]",children:e.jsxs("table",{className:"w-full text-sm text-left border border-gray-200",children:[e.jsx("thead",{className:"bg-purple-600 text-white sticky top-0 z-10",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2",children:"#"}),e.jsx("th",{className:"px-4 py-2",children:"Mem/Id"}),e.jsx("th",{className:"px-4 py-2",children:"Name"}),e.jsx("th",{className:"px-4 py-2",children:"Mobile"})]})}),e.jsx("tbody",{className:"divide-y divide-gray-100",children:r.map((c,S)=>e.jsxs("tr",{onClick:()=>{b(c),d(!0)},className:"hover:bg-purple-100 transition duration-150",children:[e.jsx("td",{className:"px-4 py-2",children:S+1}),e.jsx("td",{className:"px-4 py-2 font-medium",children:c.customerId}),e.jsx("td",{className:"px-4 py-2",children:c.name}),e.jsx("td",{className:"px-4 py-2",children:c.mobile})]},c.customerId))})]})})}),e.jsx(at,{isOpen:l,onRequestClose:()=>d(!1),contentLabel:"Member Details",overlayClassName:"fixed inset-0 bg-[#00000099] bg-opacity-50 flex items-center justify-center z-50",className:"max-w-5xl w-full h-[97vh] overflow-y-auto bg-white p-6 rounded-lg shadow-2xl border-4 border-gray-400",children:o&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"w-full flex justify-between items-center pb-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"👤 Member Details"}),e.jsx("button",{className:"text-gray-500 hover:text-gray-800",onClick:()=>d(!1),children:"✖"})]}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-lg font-semibold",children:["Number: ",o.customerId]}),e.jsxs("p",{className:"text-lg font-semibold",children:["Name  : ",o.title?`${o.title} ${o.name}`:o.name]})]}),e.jsx("div",{className:"flex border-b gap-6 text-sm font-medium text-gray-600",children:["Overview"].map(c=>e.jsx("button",{onClick:()=>p(c),className:`pb-2 ${x===c?"border-b-2 border-blue-600 text-blue-600":""}`,children:c},c))})]})})]})}function Tt(){var Te;const r=ee(),[n,a]=t.useState(!1),[i,s]=t.useState(""),[l,d]=t.useState(""),[o,b]=t.useState({}),[x,p]=t.useState([]),[c,S]=t.useState(""),[g,N]=t.useState(0),[u,w]=t.useState(0),[v,h]=t.useState(0),[A,D]=t.useState(0),[f,C]=t.useState(0),[O,E]=t.useState(0),[W,Z]=t.useState(!1),[me,ae]=t.useState(!1),[ce,te]=t.useState(""),[B,Y]=t.useState(""),[K,J]=t.useState(""),[F,ie]=t.useState(""),[he,pe]=t.useState([]),[ve,I]=t.useState([]),[z,P]=t.useState(""),[T,M]=t.useState(!1),[R,re]=t.useState(!1),[ge,ye]=t.useState(!1),[Se,Ne]=t.useState(!1),[fe,k]=t.useState(!1),[$,_]=t.useState(!1),[U,le]=t.useState(!0),ue=["සුභසාධන ණය","කෙටි කාලීන ණය","දිගු කාලීන ණය","ව්යාපෘති ණය"],oe=["Welfare Loan","Short Term Loan","Long Term Loan","Project Loan"],se=async L=>{var G,Q;if(De(),!(!L||L==="0")){a(!0),b({});try{try{const H=await y.get(`http://localhost:3000/api/customer/${L}`);if(!H.data){m.error("සාමාජික අංකය වලංගු නැත");return}b(H.data)}catch(H){((G=H.response)==null?void 0:G.status)===404?m.error("සාමාජික අංකය නොමැත."):(m.error("අයදුම්පත සෙවීම අසාර්ථක විය."),console.error(H))}const X=await y.get(`http://localhost:3000/api/loanMaster/pending-customer/${L}`);p(X.data);try{const H=await y.get(`http://localhost:3000/api/loanMaster/application/${L}`);H.data&&(s(H.data.loanId),S(H.data.loanType),N(H.data.amount??0),w(H.data.maxAmount??0),h(H.data.loanInterestRate??0),D(H.data.loanDuration??0),C(H.data.maxDuration??0),E(H.data.firstInstallment??0),Z(H.data.isApproved),ae(H.data.isGranted),J(H.data.firstGuarantorId??""),ie(H.data.secondGuarantorId??""),le(!1),H.data.isRejected?P("⛔කණගාටුයි, ඔබේ ණය අයදුම්පත ප්‍රතික්ෂේප කර ඇත. කරුණාකර වැඩි විස්තර සඳහා කළමනාකරු අමතන්න."):H.data.isApproved?P("✅ඔබගේ ණය අයදුම්පත අනුමත කර ඇත. කරුණාකර කළමනාකරුගෙන් ණය මුදල ලබා ගන්න."):P("⌛ඔබගේ ණය අයදුම්පත අනුමැතිය සඳහා සමාලෝචනය කෙරෙමින් පවතී. කරුණාකර රැඳී සිටින්න."))}catch(H){((Q=H.response)==null?void 0:Q.status)===404?De():m.error("අයදුම්පත සෙවීම අසාර්ථක විය.")}}finally{a(!1)}}},ke=async L=>{var G;if(!(!L||L==="0")){a(!0);try{const Q=await y.get(`http://localhost:3000/api/customer/${L}`);if(!Q.data)return m.error("සාමාජික අංකය වලංගු නැත");te(Q.data);try{const X=await y.get(`http://localhost:3000/api/loanMaster/pending-guarantor/${L}`);pe(X.data)}catch(X){((G=X.response)==null?void 0:G.status)===404?pe([]):(console.error(X),m.error("Failed to fetch guarantor loans"))}}finally{a(!1)}}},Ve=async L=>{var G;if(!(!L||L==="0")){a(!0);try{const Q=await y.get(`http://localhost:3000/api/customer/${L}`);if(!Q.data)return m.error("සාමාජික අංකය වලංගු නැත");Y(Q.data);try{const X=await y.get(`http://localhost:3000/api/loanMaster/pending-guarantor/${L}`);I(X.data)}catch(X){((G=X.response)==null?void 0:G.status)===404?I([]):(console.error(X),m.error("Guarantor loans fetch failed"))}}finally{a(!1)}}},We=L=>{M(!1),D(""),N(""),h(""),w(""),C(""),J(""),ie(""),L==="Welfare Loan"?(C(2),h(5),w(o.shares*.4)):L==="Short Term Loan"?(C(12),h(2.5),w(o.shares*.7)):L==="Long Term Loan"?(C(24),h(1.5),w(o.shares*1.5)):L==="Project Loan"&&(h(1.5),w(2e5))};t.useEffect(()=>{g>0&&A>0&&v>0?E((g/A+g*v/100).toFixed(2)):E("")},[c,g,A]);const De=()=>{s(""),S(""),N(0),w(0),h(0),D(0),C(0),E(0),Z(!1),ae(!1),J(""),ie(""),p([]),P(""),le(!0),_(!1),M(!1),re(!1),ye(!1),Ne(!1)},Ye=()=>{if(P(""),!l)return M(!1),_(!1),m.error("පළමුව අයදුම්කරුගේ සාමාජික අංකය ඉදිරිපත් කරන්න.");if(!c)return M(!1),_(!1),m.error("ණය වර්ගය තෝරන්න");if(!g)return M(!1),_(!1),m.error("ණය මුදල ඇතුළත් කරන්න");if(!A)return M(!1),_(!1),m.error("ආපසු ගෙවීමේ කාලය ඇතුළත් කරන්න");if(c==="Long Term Loan"||c==="Project Loan"){if(!K||!F)return M(!1),_(!1),m.error("ඇපකරුවන්ගේ විස්තර සපයන්න");if(K===F)return M(!1),_(!1),m.error("ඇපකරුවන්ට එකම සාමාජිකයෙකු විය නොහැක.");if(K===l||F===l)return M(!1),_(!1),m.error("අයදුම්කරුට ඇපකරුවෙකු විය නොහැක.")}const L=new Date(o.joinDate),G=new Date,Q=G.getFullYear()-L.getFullYear();let X=!1;if(Q>1)X=!0;else if(Q===1){const je=G.getMonth()-L.getMonth();(je>0||je===0&&G.getDate()>=L.getDate())&&(X=!0)}let H=o!=null&&o.membership?Number(o.membership):0,Xe=Number(o==null?void 0:o.shares)+Number(o==null?void 0:o.profits);if(X){if(H>0){P("❌ ඔබගේ සාමාජික ගාස්තු ගෙවීම් යාවත්කාලීන නොවේ. එබැවින්, මෙම අවස්ථාවේදී ණයක් සඳහා අයදුම් කිරීමට ඔබට සුදුසුකම් නොමැත."),M(!1),_(!1);return}else if(Xe<5e3){P("❌ ඔබගේ කොටස් දායකත්වය අවශ්‍ය අවම මුදලට ළඟා වී නොමැත. එබැවින්, මෙම අවස්ථාවේදී ණයක් නිකුත් කළ නොහැක."),M(!1),_(!1);return}}else{P("❌ ඔබගේ සාමාජිකත්ව කාලය තවමත් වසරකට ළඟා වී නැත. මෙම අවස්ථාවේදී ණයක් සඳහා අයදුම් කිරීමට ඔබට සුදුසුකම් නොමැත."),M(!1),_(!1);return}for(let je of x)if(je.loanType===c){P("❌ ඔබ ඉල්ලා සිටින ණය වර්ගය දැනටමත් ලබාගෙන ඇත. එබැවින්, මේ අවස්ථාවේ දී එම වර්ගයේම තවත් ණයක් නිකුත් කළ නොහැක."),M(!1),_(!1);return}else if(je.loanType!=="Welfare Loan"&&c!=="Welfare Loan"){P("❌ ඔබට දැනටමත් ක්‍රියාකාරී ණයක් තිබේ. එබැවින්, මෙම අවස්ථාවේදී නව ණයක් නිකුත් කළ නොහැක."),M(!1),_(!1);return}else if(je.amount/2<je.dueAmount&&c==="Welfare Loan"){P("❌ ඔබගේ පවතින ණය මුදලින් අවම වශයෙන් 50% ක්වත් පියවා නොමැති බැවින්, මෙම අවස්ථාවේදී සුභසාධන ණයක් නිකුත් කළ නොහැක."),M(!1),_(!1);return}if(c==="Long Term Loan"){if(he.length>0){P("❌ තෝරාගත් පළමු ඇපකරු දැනටමත් තවත් ණයක් සඳහා අත්සන් කර ඇති අතර එම නිසා නැවත අත්සන් කිරීමට සුදුසුකම් නොලබයි."),M(!1),_(!1);return}else if(g/4>Number(ce.shares)+Number(ce.profits)){P("❌ මෙම ණය මුදල සඳහා අත්සන් කිරීමට පළමු ඇපකරුගේ කොටස් මුදල ප්‍රමාණවත් නොවේ."),M(!1),_(!1);return}if(ve.length>0){P("❌ තෝරාගත් දෙවන ඇපකරු දැනටමත් තවත් ණයක් සඳහා අත්සන් කර ඇති අතර එම නිසා නැවත අත්සන් කිරීමට සුදුසුකම් නොලබයි."),M(!1),_(!1);return}else if(g/4>Number(B.shares)+Number(B.profits)){P("❌ මෙම ණය මුදල සඳහා අත්සන් කිරීමට දෙවන ඇපකරුගේ කොටස් මුදල ප්‍රමාණවත් නොවේ."),M(!1),_(!1);return}}P("✅ඔබගේ ණය අයදුම්පත සූදානම් සහ ඉදිරිපත් කිරීමට සුදුසුකම් ලබා ඇත. අනුමැතිය සඳහා එය ඉදිරිපත් කිරීමට කරුණාකර පහත බොත්තම ක්ලික් කරන්න."),M(!0),_(!1)},Je=async()=>{if(!T)return;let L="";try{try{const G={customerId:l,firstGuarantorId:K,secondGuarantorId:F,applicationDate:new Date,loanType:c,amount:g,loanDuration:A,loanInterestRate:v,dueAmount:g,isGranted:!1},Q=await y.post("http://localhost:3000/api/loanMaster",G);L=Q.data.referenceNo,s(Q.data.referenceNo)}catch(G){console.log("1️⃣⚠️ create loan application error: ",G)}}catch(G){console.log(G)}m.success("ඔබගේ ණය අයදුම්පත සාර්ථකව ඉදිරිපත් කර ඇත. අනුමැතිය සඳහා එය සමාලෝචනය කරන තෙක් රැඳී සිටින්න."),ye(!0),re(!1)},Ke=async()=>{if(U||!i)return m.error("ඇතුළත් කළ අයදුම්පතක් නොමැත.");const L=i;try{await y.delete(`http://localhost:3000/api/loanMaster/delete/${L}`),m.success("ණය අයදුම්පත සාර්ථකව ඉවත් කර ඇත."),k(!0),r(-1)}catch(G){console.error("Delete loan error:",G),m.error("අයදුම්පත ඉවත් කිරීම අසාර්ථක විය.")}};return e.jsxs("div",{className:"flex flex-col w-full px-4 py-6 space-y-6  max-w-5xl mx-auto",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("h1",{className:"text-3xl font-bold text-indigo-700 mb-1",children:"🛒 ණය අයදුම්පත"}),e.jsx("p",{className:"text-indigo-500 text-sm",children:"ඉක්මනින් සහ ආරක්ෂිතව ණයක් සඳහා අයදුම් කරන්න."})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-indigo-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsx("label",{className:"font-semibold text-indigo-700 w-40",children:"සාමාජික අංකය:"}),e.jsx("input",{type:"text",className:"border border-indigo-300 rounded-lg p-2 w-full md:w-24 text-center focus:outline-none focus:ring-2 focus:ring-indigo-400",placeholder:"000",maxLength:3,value:l,onChange:async L=>{const G=L.target.value;d(G),G.length===3&&await se(G)}})]}),n?e.jsx(ne,{}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-indigo-700 font-medium",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"නම:"}),e.jsx("span",{children:(o==null?void 0:o.name)||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"සම්බන්ධ දිනය:"}),e.jsx("span",{children:((Te=o==null?void 0:o.joinDate)==null?void 0:Te.slice(0,10))||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"හිග​ සාමාජික ගාස්තු:"}),e.jsx("span",{children:V(o==null?void 0:o.membership)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"කොටස් මුදල:"}),e.jsx("span",{children:V(o==null?void 0:o.shares)})]})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-orange-500",children:[e.jsx("p",{className:"text-orange-600 font-semibold text-sm sm:text-base",children:"ලබාගෙන ඇති අනෙකුත් ණය:"}),e.jsxs("table",{className:"w-full border-collapse text-sm",children:[e.jsx("thead",{className:"bg-orange-50 text-orange-700 font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-3 py-2",children:"දිනය"}),e.jsx("th",{className:"border px-3 py-2",children:"ණය වර්ගය"}),e.jsx("th",{className:"border px-3 py-2",children:"මුදල"}),e.jsx("th",{className:"border px-3 py-2",children:"ශේෂය"})]})}),e.jsx("tbody",{children:x!=null&&x.length?x.map((L,G)=>e.jsxs("tr",{className:"hover:bg-orange-50 transition",children:[e.jsx("td",{className:"border px-3 py-1",children:new Date(L.issuedDate).toLocaleDateString("en-GB")}),e.jsx("td",{className:"border px-3 py-1",children:L.loanType}),e.jsx("td",{className:"border px-3 py-1",children:V(L.amount)}),e.jsx("td",{className:"border px-3 py-1",children:V(L.dueAmount)})]},L.id??G)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-3 text-gray-400 italic",children:"වෙනත් ණය ගෙන නැත"})})})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-pink-500",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"font-medium text-pink-700",children:"ණය වර්ගය"}),e.jsxs("select",{disabled:!U,className:`mt-1 w-full border rounded-lg p-2 focus:ring-2 focus:ring-pink-400 ${U?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`,value:c??"",onChange:L=>{S(L.target.value),We(L.target.value)},children:[e.jsx("option",{value:"",children:"තෝරන්න"}),ue.map((L,G)=>e.jsx("option",{value:oe[G],children:L},oe[G]))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-medium text-pink-700",children:"මුදල"}),e.jsx("input",{type:"number",disabled:!U,value:g||"",onChange:L=>{const G=Number(L.target.value);G<=u?N(G):(m.error(`Amount cannot exceed ${V(u)}`),N(u))},className:`mt-1 w-full border rounded-lg p-2 focus:ring-2 focus:ring-pink-400 ${U?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`}),e.jsxs("small",{className:"text-gray-400",children:["Max: ",V(u)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"font-medium text-pink-700",children:"කාල සීමාව (මාස)"}),e.jsx("input",{type:"number",disabled:!U,value:A||"",onChange:L=>{const G=Number(L.target.value);G<=f?D(G):(m.error(`Duration cannot exceed ${f}`),D(f))},className:`mt-1 w-full border rounded-lg p-2 focus:ring-2 focus:ring-pink-400 ${U?"":"bg-gray-100 cursor-not-allowed text-gray-500"}`}),e.jsxs("small",{className:"text-gray-400",children:["Max: ",f]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between text-pink-700 font-semibold mt-2",children:[e.jsxs("span",{children:["පොලී අනුපාතය: ",v,"%"]}),e.jsxs("span",{children:["පළමු වාරිකය: ",V(O)]})]})]}),(c==="Long Term Loan"||c==="Project Loan")&&e.jsx("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-green-500",children:[{label:"පළමු ඇපකරු",value:K,setValue:J,data:ce,searchFn:ke},{label:"දෙවන ඇපකරු",value:F,setValue:ie,data:B,searchFn:Ve}].map((L,G)=>{var Q;return e.jsxs("div",{className:"flex flex-col sm:flex-row items-center gap-3",children:[e.jsx("label",{className:"font-medium text-green-700 w-32",children:L.label}),e.jsx("input",{type:"text",maxLength:3,value:L.value||"",onChange:async X=>{L.setValue(X.target.value),X.target.value.length===3&&await L.searchFn(X.target.value)},className:"border rounded-lg p-2 w-full sm:w-24 text-center focus:ring-2 focus:ring-green-400"}),e.jsx("span",{className:"text-gray-600 font-medium",children:((Q=L.data)==null?void 0:Q.name)||"-"})]},G)})}),e.jsxs("div",{className:"h-auto bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-blue-600 font-semibold text-sm sm:text-base",children:"ඉදිරිපත් කළ ණය අයදුම්පත:"}),e.jsx("textarea",{className:"w-full h-auto focus:ring-2 focus:ring-blue-400 text-blue-600",rows:4,value:z,onChange:L=>P(L.target.value),disabled:!T})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx("button",{disabled:!U||$,onClick:async()=>{_(!0),await Ye()},className:`w-full text-white font-semibold rounded-lg p-3 transition ${U&&!$?"bg-blue-500 hover:bg-blue-600 cursor-pointer":"bg-gray-400 cursor-not-allowed"}`,children:$?"අයදුම්පත සත්‍යාපනය වෙමින් පවතී...":!T&&U?"අයදුම්පත සත්‍යාපනය කරන්න":"අයදුම්පත සත්‍යාපනය කර ඇත"}),e.jsx("button",{disabled:!T||R||ge||!U,onClick:async()=>{re(!0),await Je()},className:`w-full rounded-lg p-3 text-white font-semibold transition ${T&&!ge?"bg-green-500 hover:bg-green-600":"bg-gray-400 cursor-not-allowed"}`,children:!ge&&U?"අනුමැතිය සඳහා ඉදිරිපත් කරන්න":R?"අයදුම්පත ඉදිරිපත් වෙමින් පවතී":"ඉදිරිපත් කිරීම සම්පූර්ණයි"}),!U&&e.jsx("button",{disabled:fe||Se,onClick:async()=>{Ne(!0),await Ke()},className:"w-full bg-red-500 hover:bg-red-600 text-white rounded-lg p-3 font-semibold transition",children:fe?"ණය අයදුම්පත ඉවත් කළා":"ණය අයදුම්පත ඉවත් කරන්න"}),e.jsx("button",{onClick:()=>r(-1),className:"w-full bg-gray-600 hover:bg-gray-700 text-white rounded-lg p-3 font-semibold transition",children:"ආපසු යන්න"})]})]})}function $t(){var fe;const r=ee(),[n,a]=t.useState(!1),[i,s]=t.useState(!1),[l,d]=t.useState(!1),[o,b]=t.useState(""),[x,p]=t.useState({}),[c,S]=t.useState({}),[g,N]=t.useState([]),[u,w]=t.useState(""),[v,h]=t.useState([]),[A,D]=t.useState(""),[f,C]=t.useState(""),[O,E]=t.useState(""),[W,Z]=t.useState(""),[me,ae]=t.useState(""),[ce,te]=t.useState(""),[B,Y]=t.useState(""),[K,J]=t.useState(""),[F,ie]=t.useState(""),[he,pe]=t.useState(""),[ve,I]=t.useState(""),[z,P]=t.useState(!1),[T,M]=t.useState({chairman:!1,secretary:!1,treasurer:!1,executive:!1,manager:!1}),R=async k=>{var $,_;if(!(!k||k==="0")){a(!0),w(""),D(""),C(0),E(0),Z(""),ae(0),te(0),ie(""),pe(""),I("");try{const U=await y.get(`http://localhost:3000/api/loanMaster/pending-approval/${k}`);if(U.data){p(U.data);const le=await y.get(`http://localhost:3000/api/customer/${k}`);S(le.data);const ue=await y.get(`http://localhost:3000/api/memberTransaction/membership-fee/${k}`);h(ue.data);const oe=await y.get(`http://localhost:3000/api/loanMaster/pending-customer/${k}`);N(oe.data);const se=U.data,ke=Number(le.data.shares?le.data.shares:0)+Number(le.data.profit?le.data.profit:0);se.loanType==="Welfare Loan"?(ae(2),E(5),C(ke*.4),w("සුභසාධන ණය")):se.loanType==="Short Term Loan"?(ae(12),E(2.5),C(ke*.7),w("කෙටි කාලීන ණය")):se.loanType==="Long Term Loan"?(ae(24),E(1.5),C(ke*1.5),w("දිගු කාලීන ණය"),ie(se.firstGuarantorId),pe(se.secondGuarantorId),re(se.firstGuarantorId),ge(se.secondGuarantorId)):se.loanType==="Project Loan"&&(E(1.5),C(2e5),w("ව්යාපෘති ණය"),ie(se.firstGuarantorId),pe(se.secondGuarantorId),re(se.firstGuarantorId),ge(se.secondGuarantorId)),D(se.amount),Z(se.loanDuration),te((A/W+A*O/100).toFixed(2)),I("")}}catch(U){m.error(((_=($=U.response)==null?void 0:$.data)==null?void 0:_.message)||"Applicant not found")}finally{a(!1)}}},re=async k=>{var $,_;if(!(!k||k==="0")){a(!0);try{const U=await y.get(`http://localhost:3000/api/customer/${k}`);Y(U.data);const le=await y.get(`http://localhost:3000/api/loanMaster/pending-customer/${k}`);setFirstGuarantorLoans(le.data);const ue=await y.get(`http://localhost:3000/api/loanMaster/pending-guarantor/${k}`);setFGuarantoredLoans(ue.data)}catch(U){m.error(((_=($=U.response)==null?void 0:$.data)==null?void 0:_.message)||"Member not found")}finally{a(!1)}}},ge=async k=>{var $,_;if(!(!k||k==="0")){a(!0);try{const U=await y.get(`http://localhost:3000/api/customer/${k}`);J(U.data);const le=await y.get(`http://localhost:3000/api/loanMaster/pending-customer/${k}`);setSecondGuarantorLoans(le.data);const ue=await y.get(`http://localhost:3000/api/loanMaster/pending-guarantor/${k}`);setSGuarantoredLoans(ue.data)}catch(U){m.error(((_=($=U.response)==null?void 0:$.data)==null?void 0:_.message)||"Member not found")}finally{a(!1)}}};t.useEffect(()=>{A>0&&W>0&&O>0?te((A/W+A*O/100).toFixed(2)):te("")},[u,A,W]);const ye=()=>{if(P(!1),I(""),!o)return m.error("පළමුව අයදුම්කරුගේ සාමාජික අංකය ඉදිරිපත් කරන්න.");if(!u)return m.error("ණය වර්ගය තෝරන්න");if(!A)return m.error("ණය මුදල ඇතුළත් කරන්න");if(!W)return m.error("ආපසු ගෙවීමේ කාලය ඇතුළත් කරන්න");if(u==="Long Term Loan"||u==="Project Loan"){if(!F||!he)return m.error("ඇපකරුවන්ගේ විස්තර සපයන්න");if(F===he)return m.error("ඇපකරුවන්ට එකම සාමාජිකයෙකු විය නොහැක.");if(F===o||he===o)return m.error("අයදුම්කරුට ඇපකරුවෙකු විය නොහැක.")}if((u==="ව්යාපෘති ණය"||u==="දිගු කාලීන ණය")&&!T.chairman)return m.error("සභාපතිවරයාගේ අනුමැතිය ලැබී නැත..");if(!T.secretary)return m.error("ලේකම් අනුමැතිය ලැබී නැත.");if((u==="ව්යාපෘති ණය"||u==="දිගු කාලීන ණය"||u==="කෙටි කාලීන ණය")&&!T.treasurer)return m.error("භාණ්ඩාගාරික අනුමැතිය ලැබී නැත.");if(u==="ව්යාපෘති ණය"&&!T.executive)return m.error("විධායක කමිටුවේ අනුමැතිය ලැබී නැත.");if(!T.manager)return m.error("කළමනාකරුගේ අනුමැතිය ලැබී නැත.");const k=new Date(c.joinDate),$=new Date,_=$.getFullYear()-k.getFullYear();let U=!1;if(_>1)U=!0;else if(_===1){const oe=$.getMonth()-k.getMonth();(oe>0||oe===0&&$.getDate()>=k.getDate())&&(U=!0)}let le=c!=null&&c.membership?Number(c.membership):0,ue=Number(c==null?void 0:c.shares)+Number(c==null?void 0:c.profits);if(U){if(le>0){I("❌ ඔබගේ සාමාජික ගාස්තු ගෙවීම් යාවත්කාලීන නොවේ. එබැවින්, මෙම අවස්ථාවේදී ණයක් සඳහා අයදුම් කිරීමට ඔබට සුදුසුකම් නොමැත."),P(!1);return}else if(ue<5e3){I("❌ ඔබගේ කොටස් දායකත්වය අවශ්‍ය අවම මුදලට ළඟා වී නොමැත. එබැවින්, මෙම අවස්ථාවේදී ණයක් නිකුත් කළ නොහැක."),P(!1);return}}else{I("❌ ඔබගේ සාමාජිකත්ව කාලය තවමත් වසරකට ළඟා වී නැත. මෙම අවස්ථාවේදී ණයක් සඳහා අයදුම් කිරීමට ඔබට සුදුසුකම් නොමැත."),P(!1);return}if(g.map(oe=>{if(oe.loanType===u){I("❌ ඔබ ඉල්ලා සිටින ණය වර්ගය දැනටමත් ලබාගෙන ඇත. එබැවින්, මේ අවස්ථාවේ දී එම වර්ගයේම තවත් ණයක් නිකුත් කළ නොහැක."),P(!1);return}else if(oe.loanType!=="Welfare Loan"&&u!=="Welfare Loan"){I("❌ ඔබට දැනටමත් ක්‍රියාකාරී ණයක් තිබේ. එබැවින්, මෙම අවස්ථාවේදී නව ණයක් නිකුත් කළ නොහැක."),P(!1);return}else if(oe.amount/2<oe.dueAmount&&u==="Welfare Loan"){I("❌ ඔබගේ පවතින ණය මුදලින් අවම වශයෙන් 50% ක්වත් පියවා නොමැති බැවින්, මෙම අවස්ථාවේදී සුභසාධන ණයක් නිකුත් කළ නොහැක."),P(!1);return}}),u==="Long Term Loan"){if(firstGuarantorLoans.length>0){I("❌ තෝරාගත් පළමු ඇපකරු දැනටමත් තවත් ණයක් සඳහා අත්සන් කර ඇති අතර එම නිසා නැවත අත්සන් කිරීමට සුදුසුකම් නොලබයි."),P(!1);return}else if(A/4>Number(B.shares)+Number(B.profits)){I("❌ මෙම ණය මුදල සඳහා අත්සන් කිරීමට පළමු ඇපකරුගේ කොටස් මුදල ප්‍රමාණවත් නොවේ."),P(!1);return}if(secondGuarantorLoans.length>0){I("❌ තෝරාගත් දෙවන ඇපකරු දැනටමත් තවත් ණයක් සඳහා අත්සන් කර ඇති අතර එම නිසා නැවත අත්සන් කිරීමට සුදුසුකම් නොලබයි."),P(!1);return}else if(A/4>Number(K.shares)+Number(K.profits)){I("❌ මෙම ණය මුදල සඳහා අත්සන් කිරීමට දෙවන ඇපකරුගේ කොටස් මුදල ප්‍රමාණවත් නොවේ."),P(!1);return}}I("✅ණය අයදුම්පත අනුමත කර ඇති අතර එය ලබා දීමට සුදුසුකම් ලබා ඇත. ක්‍රියාවලිය සම්පූර්ණ කිරීම සඳහා කරුණාකර ගෙවීම සමඟ ඉදිරියට යන්න."),P(!0)},Se=async()=>{if(!z)return;const k=x.loanId;try{try{const $={approvalDate:new Date,isApprovedChairman:T.chairman,isApprovedSecretary:T.secretary,isApprovedTreasurer:T.treasurer,isApprovedExecutive:T.executive,isApprovedManager:T.manager,isApproved:!0,isGranted:!1};await y.put(`http://localhost:3000/api/loanMaster/update/${k}`,$)}catch($){console.log("1️⃣⚠️ create loan master error: ",$)}m.success("ණය අනුමත කරන ලදී.")}catch($){console.log($)}},Ne=async()=>{d(!0);const k=x.loanId;try{const $={approvalDate:new Date,isApproved:!1,isRejected:!0,isGranted:!1},_=await y.put(`http://localhost:3000/api/loanMaster/update/${k}`,$);m.success("ණය අයදුම්පත ප්‍රතික්ෂේප කරන ලදී.")}catch($){console.log("1️⃣⚠️ Reject loan error: ",$)}};return e.jsxs("div",{className:"flex flex-col w-full px-4 py-6 space-y-6 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-2xl sm:text-3xl font-bold text-indigo-600",children:"🛒 ණය අයදුම්පත් අනුමත කිරීම"}),e.jsx("p",{className:"text-indigo-500 text-sm sm:text-base",children:"අයදුම්පත් තොරතුරු තහවුරු කර ණය අනුමත කිරීම."})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-indigo-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsx("label",{className:"font-semibold text-indigo-700 w-40",children:"සාමාජික අංකය:"}),e.jsx("input",{type:"text",className:"border border-indigo-300 rounded-lg p-2 w-full md:w-24 text-center focus:outline-none focus:ring-2 focus:ring-indigo-400",placeholder:"000",maxLength:3,value:o,onChange:async k=>{const $=k.target.value;b($),$.length===3&&await R($)}})]}),n?e.jsx(ne,{}):e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-indigo-700 font-medium",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"නම:"}),e.jsx("span",{children:(c==null?void 0:c.name)||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"සම්බන්ධ දිනය:"}),e.jsx("span",{children:((fe=c==null?void 0:c.joinDate)==null?void 0:fe.slice(0,10))||"-"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"හිග​ සාමාජික ගාස්තු:"}),e.jsx("span",{children:V(c==null?void 0:c.membership)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"කොටස් මුදල:"}),e.jsx("span",{children:V(c==null?void 0:c.shares)})]})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-purple-500",children:[e.jsx("p",{className:"text-sm font-semibold text-purple-700",children:"සාමාජික ගාස්තු පිළිබඳ විස්තර"}),e.jsxs("table",{className:"min-w-full bg-white rounded-lg overflow-hidden shadow-md text-sm sm:text-base",children:[e.jsx("thead",{className:"bg-purple-50 text-purple-700",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-2 py-1",children:"දිනය"}),e.jsx("th",{className:"px-2 py-1",children:"විස්තරය"}),e.jsx("th",{className:"px-2 py-1",children:"මුදල"}),e.jsx("th",{className:"px-2 py-1",children:"ශේෂය"})]})}),e.jsx("tbody",{children:v!=null&&v.length?v.map(k=>e.jsxs("tr",{className:"hover:bg-purple-50",children:[e.jsx("td",{className:"px-2 py-1",children:k.transactionDate}),e.jsxs("td",{className:"px-2 py-1",children:[k.transactionType," ",k.description]}),e.jsx("td",{className:`px-2 py-1 ${k.isCredit?"text-green-500":"text-red-500"}`,children:V(k.amount)}),e.jsx("td",{className:"px-2 py-1",children:V(k.dueAmount)})]},k.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-2 text-gray-500",children:"ගනුදෙනු කිසිවක් හමු නොවේ"})})})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-orange-500",children:[e.jsx("p",{className:"text-orange-600 font-semibold text-sm sm:text-base",children:"ලබාගෙන ඇති අනෙකුත් ණය:"}),e.jsxs("table",{className:"w-full border-collapse text-sm",children:[e.jsx("thead",{className:"bg-orange-50 text-orange-700 font-semibold",children:e.jsxs("tr",{children:[e.jsx("th",{className:"border px-3 py-2",children:"දිනය"}),e.jsx("th",{className:"border px-3 py-2",children:"ණය වර්ගය"}),e.jsx("th",{className:"border px-3 py-2",children:"මුදල"}),e.jsx("th",{className:"border px-3 py-2",children:"ශේෂය"})]})}),e.jsx("tbody",{children:g!=null&&g.length?g.map((k,$)=>e.jsxs("tr",{className:"hover:bg-orange-50 transition",children:[e.jsx("td",{className:"border px-3 py-1",children:new Date(k.issuedDate).toLocaleDateString("en-GB")}),e.jsx("td",{className:"border px-3 py-1",children:k.loanType}),e.jsx("td",{className:"border px-3 py-1",children:V(k.amount)}),e.jsx("td",{className:"border px-3 py-1",children:V(k.dueAmount)})]},k.id??$)):e.jsx("tr",{children:e.jsx("td",{colSpan:"4",className:"text-center py-3 text-gray-400 italic",children:"වෙනත් ණය ගෙන නැත"})})})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-pink-500",children:[e.jsx("p",{className:"text-pink-600 font-semibold text-sm sm:text-base",children:"අයදුම් කළ ණය පිළිබඳ විස්තර:"}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-pink-500",children:"ණය වර්ගය:"}),e.jsx("span",{children:u})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium text-pink-500",children:["මුදල (Max- ",V(f),"):"]}),e.jsx("span",{children:V(A)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium text-pink-500",children:["කාල සීමාව මාස (Max- ",me,"):"]}),e.jsx("span",{children:W})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-pink-500",children:"මාසික පොලී අනුපාතය:"}),e.jsxs("span",{children:[O,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium text-pink-500",children:"පළමු වාරිකය:"}),e.jsx("span",{children:V(ce)})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-teal-600",children:[e.jsx("p",{className:"text-teal-600 font-semibold text-sm sm:text-base",children:"ණය අනුමත කිරීම:"}),u==="ව්යාපෘති ණය"||u==="දිගු කාලීන ණය"&&e.jsxs("label",{className:"flex items-center gap-2 text-teal-600",children:[e.jsx("input",{type:"checkbox",name:"chairman",checked:T.chairman,onChange:k=>M($=>({...$,chairman:k.target.checked})),className:"form-checkbox h-5 w-5 text-teal-600"}),"සභාපති අනුමැතිය"]}),e.jsxs("label",{className:"flex items-center gap-2 text-teal-600",children:[e.jsx("input",{type:"checkbox",name:"secretary",checked:T.secretary,onChange:k=>M($=>({...$,secretary:k.target.checked})),className:"form-checkbox h-5 w-5 text-teal-600"}),"ලේකම් අනුමැතිය"]}),(u==="ව්යාපෘති ණය"||u==="දිගු කාලීන ණය"||u==="කෙටි කාලීන ණය")&&e.jsxs("label",{className:"flex items-center gap-2 text-teal-600",children:[e.jsx("input",{type:"checkbox",name:"treasurer",checked:T.treasurer,onChange:k=>M($=>({...$,treasurer:k.target.checked})),className:"form-checkbox h-5 w-5 text-teal-600"}),"භාණ්ඩාගාරික අනුමැතිය"]}),u==="ව්යාපෘති ණය"&&e.jsxs("label",{className:"flex items-center gap-2 text-teal-600",children:[e.jsx("input",{type:"checkbox",name:"executive",checked:T.executive,onChange:k=>M($=>({...$,executive:k.target.checked})),className:"form-checkbox h-5 w-5 text-teal-600"}),"විධායක කමිටුවේ අනුමැතිය"]}),e.jsxs("label",{className:"flex items-center gap-2 text-teal-600",children:[e.jsx("input",{type:"checkbox",name:"manager",checked:T.manager,onChange:k=>M($=>({...$,manager:k.target.checked})),className:"form-checkbox h-5 w-5 text-teal-600"}),"කළමනාකරු අනුමැතිය"]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-blue-500",children:[e.jsx("p",{className:"text-blue-600 font-semibold text-sm sm:text-base",children:"ඉදිරිපත් කළ ණය අයදුම්පත:"}),e.jsx("textarea",{className:`w-full rounded p-2 focus:ring-2 focus:ring-blue-400 ${z?"text-blue-600":"text-red-600"}`,rows:4,value:ve,onChange:k=>I(k.target.value),disabled:!z})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 mt-4",children:[e.jsx("button",{className:"flex-1 bg-gradient-to-r from-indigo-400 to-indigo-600 text-white rounded p-2 hover:from-indigo-500 hover:to-indigo-700",onClick:ye,children:z?"ණය සත්‍යාපනය කර ඇත":"ණය අයදුම්පත සත්‍යාපනය කරන්න"}),e.jsx("button",{disabled:!z||i,className:`flex-1 rounded p-2 ${z&&!i?"bg-gradient-to-r from-green-400 to-green-600 text-white hover:from-green-500 hover:to-green-700":"bg-gray-400 cursor-not-allowed"}`,onClick:async()=>{s(!0),await Se()},children:i?"ණය අනුමත කරන ලදී":"ණය අනුමත කරන්න"}),e.jsx("button",{disabled:l||i,className:`flex-1 rounded p-2 ${!l&&!i?"bg-gradient-to-r from-red-400 to-red-600 text-white hover:from-red-500 hover:to-red-700":"bg-gray-400 cursor-not-allowed"}`,onClick:Ne,children:l?"අයදුම්පත ප්‍රතික්ෂේප කරන ලදී":"අයදුම්පත ප්‍රතික්ෂේප කරන්න"}),e.jsx("button",{onClick:()=>r(-1),className:"w-full bg-gray-600 hover:bg-gray-700 text-white rounded-lg p-3 font-semibold transition",children:"ආපසු යන්න"})]})]})}function Pt(){const r=ee(),[n,a]=t.useState(!1),[i,s]=t.useState(!1),[l,d]=t.useState(""),[o,b]=t.useState({}),[x,p]=t.useState({}),[c,S]=t.useState(""),[g,N]=t.useState(""),[u,w]=t.useState(""),[v,h]=t.useState(""),[A,D]=t.useState(""),[f,C]=t.useState(""),[O,E]=t.useState(""),[W,Z]=t.useState({chairman:!1,secretary:!1,treasurer:!1,executive:!1,manager:!1}),me=async B=>{var Y,K;if(!(!B||B==="0")){a(!0),S(""),N(""),w(0),h(""),D(0),Z({chairman:!1,secretary:!1,treasurer:!1,executive:!1,manager:!1});try{const J=await y.get(`http://localhost:3000/api/loanMaster/pending-grant/${B}`);if(J.data){b(J.data);const F=await y.get(`http://localhost:3000/api/customer/${B}`);p(F.data),J.data.loanType==="Welfare Loan"?S("සුභසාධන ණය"):J.data.loanType==="Short Term Loan"?S("කෙටි කාලීන ණය"):J.data.loanType==="Long Term Loan"?S("දිගු කාලීන ණය"):J.data.loanType==="Project Loan"&&S("ව්යාපෘති ණය"),N(J.data.amount),w(J.data.loanInterestRate),h(J.data.loanDuration)}}catch(J){m.error(((K=(Y=J.response)==null?void 0:Y.data)==null?void 0:K.message)||"Applicant not found")}finally{a(!1)}}};t.useEffect(()=>{o&&Z({chairman:o.isApprovedChairman||!1,secretary:o.isApprovedSecretary||!1,treasurer:o.isApprovedTreasurer||!1,executive:o.isApprovedExecutive||!1,manager:o.isApprovedManager||!1})},[o]),t.useEffect(()=>{g>0&&v>0&&u>0?D((g/v+g*u/100).toFixed(2)):D("")},[c,g,v]);const ae=async B=>{try{(await y.get(`http://localhost:3000/api/loanTransactions/trxbook/${B}/voucher`)).data.exists?E("🚨 This voucher number already exists!"):E("")}catch(Y){console.error("Error checking voucher:",Y),E("⚠️ Error validating voucher")}},ce=async()=>{if(!f)return s(!1),m.error("කරුණාකර වවුචර් අංකය ඇතුළත් කරන්න.");const B=o.loanId,Y="325-0001";let K="",J="";switch(c){case"සුභසාධන ණය":K="330-0001";break;case"කෙටි කාලීන ණය":K="330-0002";break;case"දිගු කාලීන ණය":K="330-0003";break;case"ව්යාපෘති ණය":K="330-0004";break}try{try{const F={issuedDate:new Date,isGranted:!0,voucherNumber:f};await y.put(`http://localhost:3000/api/loanMaster/update/${B}`,F)}catch(F){console.log("1️⃣⚠️ create loan master error: ",F)}try{const F={trxBookNo:f,loanId:B,customerId:l,transactionType:"voucher",transactionDate:new Date,totalAmount:g,isCredit:!1,description:c};J=(await y.post("http://localhost:3000/api/loanTransactions",F)).data.transaction.trxNumber}catch(F){console.log("2️⃣⚠️ create loan transaction error: ",F)}try{const F={updates:[{accountId:Y,amount:g}]};await y.put("http://localhost:3000/api/ledgerAccounts/subtract-balance",F)}catch(F){console.log("3️⃣⚠️ update cash book error: ",F)}try{const F={trxId:J,trxBookNo:f,trxDate:new Date,transactionType:"voucher",accountId:Y,description:c+" "+x.name,isCredit:!0,trxAmount:g};await y.post("http://localhost:3000/api/ledgerTransactions",F)}catch(F){console.log("4️⃣⚠️ create cash book transaction error: ",F)}try{const F={updates:[{accountId:K,amount:g}]};await y.put("http://localhost:3000/api/ledgerAccounts/add-balance",F)}catch(F){console.log("5️⃣⚠️ update loan account error: ",F)}try{const F={trxId:J,trxBookNo:f,trxDate:new Date,transactionType:"voucher",accountId:K,description:c+" "+x.name,isCredit:!1,trxAmount:g};await y.post("http://localhost:3000/api/ledgerTransactions",F)}catch(F){console.log("6️⃣⚠️ create loan account transaction error: ",F)}m.success("ඔබගේ ණය නිකුතුව සාර්ථකව අවසන් කර ඇත. කරුණාකර ඔබගේ ගිණුම පරීක්ෂා කරන්න.")}catch(F){console.log(F)}};return e.jsxs("div",{className:"flex flex-col w-full px-4 py-6 space-y-6 max-w-5xl mx-auto",children:[e.jsxs("div",{className:"text-center space-y-2",children:[e.jsx("h1",{className:"text-3xl font-extrabold text-purple-700",children:"🛒 ණය ප්‍රදානය"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"අනුමත ණය සඳහා මුදල් ගෙවීමේ පිටුව"})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-indigo-500",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsx("label",{className:"font-semibold text-indigo-700 w-40",children:"සාමාජික අංකය:"}),e.jsx("input",{type:"text",className:"border border-indigo-300 rounded-lg p-2 w-full md:w-24 text-center focus:outline-none focus:ring-2 focus:ring-indigo-400",placeholder:"000",maxLength:3,value:l,onChange:async B=>{const Y=B.target.value;d(Y),Y.length===3&&await me(Y)}})]}),n?e.jsx(ne,{}):(x==null?void 0:x.name)&&e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4 text-indigo-700 font-medium",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"නම:"}),e.jsx("span",{children:x==null?void 0:x.name})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ණය වර්ගය:"}),e.jsx("span",{children:c})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"මුදල:"}),e.jsxs("span",{children:["රු. ",V(g)]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"කාලය (මාස):"}),e.jsx("span",{children:v})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"මාසික පොලී:"}),e.jsxs("span",{children:[u,"%"]})]}),e.jsxs("div",{className:"flex justify-between font-bold",children:[e.jsx("span",{children:"පළමු වාරිකය:"}),e.jsxs("span",{children:["රු. ",V(A)]})]})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-teal-600",children:[e.jsx("p",{className:"text-teal-600 font-semibold text-sm sm:text-base",children:"ණය අනුමත කිරීම:"}),e.jsxs("div",{className:"flex flex-col gap-2",children:[c==="ව්යාපෘති ණය"||c==="දිගු කාලීන ණය"?e.jsx(te,{label:"සභාපති",checked:W.chairman}):null,e.jsx(te,{label:"ලේකම්",checked:W.secretary}),(c==="ව්යාපෘති ණය"||c==="දිගු කාලීන ණය"||c==="කෙටි කාලීන ණය")&&e.jsx(te,{label:"භාණ්ඩාගාරික",checked:W.treasurer}),c==="ව්යාපෘති ණය"&&e.jsx(te,{label:"විධායක කමිටුව",checked:W.executive}),e.jsx(te,{label:"කළමනාකරු",checked:W.manager})]})]}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-green-600",children:[e.jsx("label",{className:"block font-medium text-green-600 text-lg",children:"වවුචර් අංකය"}),e.jsx("input",{type:"text",className:`text-green-600 border border-green-300 rounded-lg w-full p-3 text-center text-lg tracking-widest focus:ring-2 focus:ring-purple-500 outline-none ${O?"border-red-500":"border-gray-300"}`,value:f,placeholder:"0000",onChange:B=>{const Y=B.target.value.replace(/\D/g,"");C(Y)},onBlur:()=>{const B=f.padStart(4,"0");C(B),B!=="0000"&&ae(B)},maxLength:4}),O&&e.jsx("div",{className:"bg-red-50 text-red-600 p-2 rounded-md text-sm",children:O})]}),e.jsxs("div",{children:[e.jsx("button",{disabled:i,onClick:async()=>{s(!0),await ce()},className:`w-full py-3 rounded-lg font-bold text-lg transition ${i?"bg-gray-300 cursor-not-allowed text-gray-600":"bg-gradient-to-r from-green-500 to-green-600 text-white hover:from-green-600 hover:to-green-700"}`,children:i?"✅ ණය ප්‍රදානය සාර්ථකයි":"💳 ණය මුදල ලබා දෙන්න"}),e.jsx("button",{onClick:()=>r(-1),className:"mt-8 w-full p-4 rounded-xl font-semibold text-white bg-gray-600 hover:bg-red-600 transition",children:"ආපසු යන්න"})]})]});function te({label:B,checked:Y}){return e.jsxs("label",{className:"flex items-center gap-2 text-gray-700",children:[e.jsx("input",{type:"checkbox",checked:Y,readOnly:!0,className:"h-5 w-5 text-purple-600 rounded-md border-gray-300 focus:ring-purple-500"}),B," අනුමැතිය"]})}}function Ft(){const[r,n]=t.useState(!1),[a,i]=t.useState(!1),[s,l]=t.useState(""),[d,o]=t.useState({}),[b,x]=t.useState([]),[p,c]=t.useState({}),[S,g]=t.useState(""),[N,u]=t.useState(""),[w,v]=t.useState(""),[h,A]=t.useState({}),[D,f]=t.useState(0),[C,O]=t.useState(0),[E,W]=t.useState(0),[Z,me]=t.useState(0),[ae,ce]=t.useState(""),[te,B]=t.useState(!1),[Y,K]=t.useState(!1),J=ee(),F={"Welfare Loan":"සුභසාධන ණය","Short Term Loan":"කෙටි කාලීන ණය","Long Term Loan":"දිගු කාලීන ණය","Project Loan":"ව්යාපෘති ණය"},ie=async I=>{var z,P;if(!(!I||I==="0")){n(!0);try{const T=await y.get(`http://localhost:3000/api/loanMaster/customer/${I}`);if(T.data){const M=T.data.map(re=>({...re,loanTypeSinhala:F[re.loanType]||re.loanType}));x(M);const R=await y.get(`http://localhost:3000/api/customer/${I}`);R.data&&o(R.data)}}catch(T){m.error(((P=(z=T.response)==null?void 0:z.data)==null?void 0:P.message)||"Applicant not found")}finally{n(!1)}}};t.useEffect(()=>{(async()=>{var z,P;if(N){i(!0);try{const T=await y.get(`http://localhost:3000/api/loanMaster/loan/${N}`);if(T.data){try{const k=s,$=N,U=await y.get(`http://localhost:3000/api/loanTransactions/last-trx/${k}/${$}/receipt`);U.data?A(U.data):(A({}),f(0))}catch(k){console.error("Error fetching last transaction:",k)}c(T.data),g(T.data.loanType);const M=new Date(T.data.issuedDate),R=new Date(M);R.setMonth(M.getMonth()+T.data.loanDuration),v(R),f(T.data.loanInterestRate||0);const re=Number(T.data.amount)/Number(T.data.loanDuration)||0,ge=he(M),ye=Math.floor(ge/30),Se=re*ye,Ne=Number(T.data.amount)-Number(T.data.dueAmount)||0,fe=re+(Se-Ne);O(fe>0?fe.toFixed(2):0)}else c({}),v(""),A({}),f(0)}catch(T){m.error(((P=(z=T.response)==null?void 0:z.data)==null?void 0:P.message)||"Loan details not found")}finally{i(!1)}}})()},[N]);function he(I){const z=new Date,P=new Date(I),T=z.getTime()-P.getTime();return Math.floor(T/(1e3*60*60*24))}t.useEffect(()=>{const I=h&&h.createdAt?new Date(h.createdAt):p.issuedDate?new Date(p.issuedDate):null,z=I?he(I):0,T=(p.dueAmount||0)*(p.loanInterestRate||0)/100/30,M=(z*T).toFixed(2),R=parseFloat(M||0)+parseFloat(C||0);f(M),W(R)},[D,C]);const pe=async I=>{try{(await y.get(`http://localhost:3000/api/loanTransactions/trxbook/${I}/receipt`)).data.length>0?ce("🚨 මෙම රිසිට්පත් අංකය දැනටමත් පවතී!"):ce("")}catch(z){console.error("Error checking receipt:",z),ce("⚠️ Error validating receipt number")}},ve=async()=>{var M;if(B(!0),!s||s==="0"){m.error("වලංගු නොවන අයදුම්කරු අංකයක්"),B(!1);return}if(!Z){m.error("කරුණාකර ලදුපත් අංකයක් ඇතුළත් කරන්න."),B(!1);return}if(ae){m.error(ae),B(!1);return}let I="";const z="325-0001",P=p.loanId;let T="";switch(S){case"Welfare Loan":I="211-0003";break;case"Short Term Loan":I="211-0004";break;case"Long Term Loan":I="211-0005";break;case"Project Loan":I="211-0006";break;default:m.error("Invalid loan type"),B(!1);return}try{try{const R={trxBookNo:Z,loanId:N,customerId:s,transactionDate:new Date,interest:parseFloat(D)||0,installment:parseFloat(C)||0,totalAmount:parseFloat(E)||0,transactionType:"receipt",isCredit:!0,description:S};T=(await y.post("http://localhost:3000/api/loanTransactions",R)).data.transaction.trxNumber}catch(R){console.log("1️⃣⚠️ create loan transaction error: ",R)}try{const R={dueAmount:Math.max((p.dueAmount||0)-(C||0),0)};await y.put(`http://localhost:3000/api/loanMaster/update/${P}`,R)}catch(R){console.log("2️⃣⚠️ create loan master error: ",R)}try{const R={updates:[{accountId:z,amount:parseFloat(E)||0}]};await y.put("http://localhost:3000/api/ledgerAccounts/add-balance",R)}catch(R){console.log("3️⃣⚠️ update cash book error: ",R)}try{const R={trxId:String(T),trxBookNo:String(Z).padStart(6,"0"),trxDate:new Date().toISOString(),transactionType:"receipt",accountId:z,description:`${S} ${(d==null?void 0:d.name)||""}`,isCredit:!1,trxAmount:parseFloat(E)||0};await y.post("http://localhost:3000/api/ledgerTransactions",R)}catch(R){console.error("4️⃣⚠️ create cash book transaction error:",((M=R.response)==null?void 0:M.data)||R.message)}try{const R={updates:[{accountId:I,amount:parseFloat(C)||0}]};await y.put("http://localhost:3000/api/ledgerAccounts/subtract-balance",R)}catch(R){console.log("5️⃣⚠️ update loan account error: ",R)}try{const R={trxId:T,trxBookNo:Z,trxDate:new Date().toISOString(),transactionType:"receipt",accountId:I,description:S+" "+d.name,isCredit:!0,trxAmount:C};await y.post("http://localhost:3000/api/ledgerTransactions",R)}catch(R){console.log("6️⃣⚠️ create loan account transaction error: ",R)}m.success("🎉 කුවිතාන්සිය සාර්ථකව ඉදිරිපත් කළා!"),K(!0)}catch(R){console.error("⚠️ Submit failed:",R),m.error("❌ රිසිට්පත ඉදිරිපත් කිරීමට අසමත් විය. කරුණාකර නැවත උත්සාහ කරන්න.")}finally{B(!1)}};return e.jsxs("div",{className:"flex flex-col w-full max-w-lg mx-auto px-4 py-6 space-y-6",children:[e.jsxs("div",{className:"text-center space-y-1",children:[e.jsx("h1",{className:"text-2xl font-bold text-purple-700",children:"🧾 ණය වාරික ගෙවීම්"}),e.jsx("p",{className:"text-sm text-gray-600",children:"ණය වාරික සහ පොලී ගෙවීම් පිළිබඳ විස්තර සහ ගෙවීම් සිදුකිරීම."})]}),e.jsxs("div",{className:"bg-white shadow-md rounded-xl p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"සාමාජික අංකය"}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg p-3 text-center focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"000",maxLength:3,value:s,onChange:async I=>{const z=I.target.value;l(z),z.length===3&&await ie(z)}})]}),r?e.jsx(ne,{}):b&&b.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"සාමාජිකයාගේ නම"}),e.jsx("div",{className:"w-full bg-purple-50 border border-purple-200 rounded-lg p-3 text-center font-medium text-purple-700",children:(d==null?void 0:d.name)||""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ණය ගිණුම තෝරා ගන්න"}),e.jsxs("select",{className:"w-full p-3 rounded-lg border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-purple-500",value:N,onChange:I=>u(I.target.value),children:[e.jsx("option",{value:"",children:"Select Loan Type"}),b.map(I=>e.jsx("option",{value:I.loanId||I.loanId,children:I.loanTypeSinhala},I.id||I._id))]})]})]}):e.jsx("p",{className:"text-center text-gray-500",children:"ණය ගිණුමක් සොයාගත නොහැක."})]}),a?e.jsx(ne,{}):p&&p.loanId?e.jsxs("div",{className:"bg-white shadow-md rounded-xl p-4 space-y-3",children:[e.jsx("h2",{className:"font-semibold text-purple-700",children:"📊 ණය විස්තර"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ලබාගත් ණය මුදල:"}),e.jsx("span",{className:"font-medium",children:V(p.amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ගෙවීමට නියමිත ශේෂය:"}),e.jsx("span",{className:"font-medium",children:V(p.dueAmount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"මාසික පොලී අනුපාතය:"}),e.jsxs("span",{children:[p.loanInterestRate,"%"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"වාරික ගණන:"}),e.jsx("span",{children:p.loanDuration})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"ණය නිකුත් කළ දිනය:"}),e.jsx("span",{children:new Date(p.issuedDate).toLocaleDateString("uk")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"අවසන් කළ යුතු දිනය:"}),e.jsx("span",{children:new Date(w).toLocaleDateString("uk")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"අවසන් ගෙවීම් දිනය:"}),e.jsx("span",{children:h!=null&&h.createdAt?new Date(h.createdAt).toLocaleDateString("uk"):"N/A"})]})]})]}):null,p&&p.loanId?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white shadow-md rounded-xl p-4 space-y-4",children:[e.jsx("h2",{className:"font-semibold text-purple-700",children:"💰 ගෙවීම් විස්තර"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"අදාළ පොලිය"}),e.jsx("input",{type:"number",value:D,readOnly:!0,className:"w-full p-3 border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"අදාළ වාරිකය"}),e.jsx("input",{type:"number",value:C,onChange:I=>O(I.target.value),className:"w-full p-3 border border-gray-300 rounded-lg text-right focus:outline-none focus:ring-2 focus:ring-purple-500"})]}),e.jsxs("div",{className:"flex justify-between items-center text-lg font-semibold border-t pt-3",children:[e.jsx("span",{children:"මුළු ගෙවීම්:"}),e.jsx("span",{className:"text-purple-700",children:V(E)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"රිසිට් අංකය"}),e.jsx("input",{type:"text",className:`w-full p-3 rounded-lg text-center border ${ae?"border-red-500":"border-gray-300"} focus:outline-none focus:ring-2 focus:ring-purple-500`,value:Z,placeholder:"000000",onChange:I=>{const z=I.target.value.replace(/\D/g,"");me(z)},onBlur:()=>{const I=String(Z).padStart(6,"0");me(I),I!=="000000"&&pe(I)},maxLength:6}),ae&&e.jsx("p",{className:"text-sm text-red-500 mt-1",children:ae})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx("button",{disabled:te||Y,onClick:async()=>{B(!0),await ve()},className:`w-full p-4 rounded-xl font-semibold text-white transition ${!te&&!Y?"bg-green-600 hover:bg-green-700":"bg-gray-400 cursor-not-allowed"}`,children:te?"ගෙවීම ඉදිරිපත් කරයි...":Y?"✅ ගෙවීම් සම්පූර්ණයි":"තහවුරු කරන්න"}),e.jsx("button",{onClick:()=>J(-1),className:"w-full bg-gray-600 hover:bg-gray-700 text-white rounded-lg p-3 font-semibold transition",children:"ආපසු යන්න"})]})]}):null]})}function Mt(){return e.jsx("div",{children:"ReceiptMembershipPage"})}function Rt(r,n,a){const[i,s]=t.useState([]),[l,d]=t.useState(!1),[o,b]=t.useState(null),[x,p]=t.useState(0),[c,S]=t.useState(0),[g,N]=t.useState(0);return t.useEffect(()=>{if(!r||!n||!a)return;(async()=>{d(!0),b(null);try{const{data:w}=await y.get(`http://localhost:3000/api/ledgerTransactions/${encodeURIComponent(r)}`),{rows:v,totals:h}=Gt(w,n,a);s(v),p(h.balanceBF),S(h.receivedAm),N(h.spentAm)}catch(w){console.error(w),b("Failed to fetch cash-book data.")}finally{d(!1)}})()},[r,n,a]),{cashbook:i,loading:l,error:o,balanceBF:x,receivedAm:c,spentAm:g}}function Gt(r,n,a){const i=new Date(n);i.setHours(0,0,0,0);const s=new Date(a);s.setHours(23,59,59,999);const l=[],d=[];for(const g of r){const N=new Date(g.trxDate);N<i?l.push(g):N<=s&&d.push(g)}const o=l.reduce((g,N)=>g+(N.isCredit?-N.trxAmount:N.trxAmount),0);let b=[],x=o;o!==0&&b.push(Fe({trxDate:i,trxId:"B/F",transactionType:"Balance B/F",description:"As At "+i.toLocaleDateString("en-GB"),isCredit:o<0,trxAmount:Math.abs(o),createdAt:i},o));let p=0,c=0;const S=d.sort((g,N)=>new Date(g.trxDate)-new Date(N.trxDate)).map(g=>(x+=g.isCredit?-g.trxAmount:g.trxAmount,g.isCredit?c+=g.trxAmount:p+=g.trxAmount,Fe(g,x)));return{rows:[...b,...S],totals:{balanceBF:o,receivedAm:p,spentAm:c}}}function Fe(r,n){const a=r.isCredit;return{date:new Date(r.trxDate).toLocaleDateString("en-GB"),trxId:r.trxBookNo||r.trxId,trxType:r.transactionType||"",description:r.description||"",debit:a?"0.00":r.trxAmount.toLocaleString("en-US",{minimumFractionDigits:2}),credit:a?r.trxAmount.toLocaleString("en-US",{minimumFractionDigits:2}):"0.00",balance:n.toLocaleString("en-US",{minimumFractionDigits:2}),createdAt:new Date(r.createdAt)}}function Et({accountId:r,fromDate:n,toDate:a}){const{cashbook:i,loading:s,error:l,balanceBF:d,receivedAm:o,spentAm:b}=Rt(r,n,a);return r?s?e.jsx("p",{className:"text-gray-500 px-4 py-2",children:"Loading cash book..."}):l?e.jsx("p",{className:"text-red-500 px-4 py-2",children:l}):e.jsxs("div",{className:"w-full h-full text-sm text-gray-700 rounded bg-gray-50 shadow",children:[e.jsxs("div",{className:"mb-4 ml-2 mr-2 p-2 text-sm flex flex-col rounded-lg border bg-pink-50 font-semibold text-pink-700",children:[e.jsxs("div",{className:"p-1 flex justify-between",children:[e.jsx("label",{className:"text-xs font-semibold",children:"ඉදිරියට ගෙන ආ ශේෂය"}),"Rs."," ",Number(d??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("div",{className:"p-1 flex justify-between",children:[e.jsx("label",{className:"text-xs font-semibold",children:"මුළු ලැබීම්"}),"Rs."," ",Number(o??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]}),e.jsxs("div",{className:"p-1 flex justify-between",children:[e.jsx("label",{className:"text-xs font-semibold",children:"මුළු ගෙවීම්"}),"Rs."," ",Number(b??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"hidden md:grid grid-cols-[100px_120px_120px_280px_120px_120px_120px] font-semibold bg-gray-200 px-4 py-2",children:[e.jsx("span",{children:"Date"}),e.jsx("span",{children:"Reference"}),e.jsx("span",{children:"Type"}),e.jsx("span",{children:"Description"}),e.jsx("span",{className:"text-right",children:"Debit"}),e.jsx("span",{className:"text-right",children:"Credit"}),e.jsx("span",{className:"text-right",children:"Balance"})]}),e.jsx("div",{className:"overflow-y-auto max-h-[60vh]",children:i.length===0?e.jsx("p",{className:"text-sm text-gray-500 px-4 py-2",children:"No Transaction Records available."}):e.jsx("div",{className:"text-sm text-gray-800",children:i.map((x,p)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[100px_120px_120px_280px_120px_120px_120px] px-4 py-2 border-b border-gray-200 hover:bg-gray-100 gap-1 md:gap-0",children:[e.jsxs("div",{className:"flex justify-between md:hidden",children:[e.jsxs("span",{className:"flex gap-4",children:[e.jsx("span",{children:x.date}),e.jsx("span",{children:x.trxId}),e.jsx("span",{children:x.trxType})]}),e.jsx("span",{className:`text-right ${x.debit==="0.00"?"text-green-600":"text-red-600"}`,children:x.debit==="0.00"?x.credit:x.debit})]}),e.jsxs("div",{className:"flex justify-between md:hidden",children:[e.jsx("span",{children:x.description}),e.jsx("span",{className:`text-right ${x.balance>"0.00"?"text-gray-600":"text-red-600"}`,children:x.balance})]}),e.jsx("span",{className:"hidden md:block",children:x.date}),e.jsx("span",{className:"hidden md:block",children:x.trxId}),e.jsx("span",{className:"hidden md:block",children:x.trxType}),e.jsx("span",{className:"hidden md:block",children:x.description}),e.jsx("span",{className:"hidden md:block text-right",children:x.debit==="0.00"?"—":x.debit}),e.jsx("span",{className:"hidden md:block text-right",children:x.credit==="0.00"?"—":x.credit}),e.jsx("span",{className:"hidden md:block text-right",children:x.balance})]},`${x.trxId}-${p}`))})})]}):e.jsx("p",{className:"text-gray-500 px-4 py-2",children:"No account selected"})}function Ot(){const[r,n]=t.useState([]),[a,i]=t.useState(""),[s,l]=t.useState(0),[d,o]=t.useState(!0),[b,x]=t.useState(""),[p,c]=t.useState(""),[S,g]=t.useState(new Date().toISOString().split("T")[0]),[N,u]=t.useState(new Date().toISOString().split("T")[0]),[w,v]=t.useState("");t.useEffect(()=>{if(!d)return;(async()=>{try{const C=(await y.get("http://localhost:3000/api/ledgerAccounts")).data.filter(O=>O.headerAccountId==="325"||O.headerAccountId==="327");n(C.sort((O,E)=>O.accountId.localeCompare(E.accountId)))}catch(f){console.error("Failed to fetch accounts:",f),m.error("Failed to fetch account/bank data.")}finally{o(!1)}})()},[d]);const h=(D,f)=>{D&&f&&new Date(D)>new Date(f)?v("⚠️ From Date must be earlier than To Date"):v("")},A=D=>{const f=D.target.value;i(f);const C=r.find(O=>O.accountId===f||O._id===f);l((C==null?void 0:C.accountBalance)??0)};return e.jsxs("div",{className:"flex flex-col  max-w-5xl mx-auto min-h-screen",children:[e.jsx("div",{className:"sticky top-0 z-30 bg-gradient-to-r from-blue-500 to-indigo-500 text-white p-4 shadow-md flex flex-col md:flex-row md:items-center md:justify-between gap-3 rounded-b-lg",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"💵 මුදල් පොත"}),e.jsx("p",{className:"text-xs opacity-90",children:"මුදල් සහ බැංකු ගනුදෙනු නිරීක්ෂණය කරන්න"})]})}),e.jsxs("div",{className:"bg-gray-50 shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-indigo-500 mt-6",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-xs font-semibold text-indigo-600",children:"ගිණුම"}),e.jsxs("select",{value:a,onChange:A,className:"w-full mt-1 px-3 py-2 text-sm text-indigo-600 rounded-lg border border-indigo-500 focus:ring-2 focus:ring-indigo-400",children:[e.jsx("option",{value:"",children:"-- Select --"}),r.map((D,f)=>e.jsx("option",{value:D.accountId||D._id,children:D.accountName||D.accountsName},`${D.accountId||D._id}-${f}`))]})]}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"mt-1 px-3 py-2 text-sm flex justify-between rounded-lg border bg-indigo-50 font-semibold text-indigo-700",children:[e.jsx("label",{className:"text-xs font-semibold",children:"ගිණුම් ශේෂය"}),"Rs."," ",Number(s??0).toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})]})})]}),e.jsx("div",{className:"bg-gray-50 shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-orange-500 mt-6",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-orange-600",children:"දින සිට"}),e.jsx("input",{type:"date",value:S,onChange:D=>{g(D.target.value),h(D.target.value,N)},max:N,className:"w-full mt-1 px-3 py-2 text-sm border border-orange-600 rounded-lg focus:ring-2 focus:ring-blue-400"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-semibold text-orange-600",children:"දිනය දක්වා"}),e.jsx("input",{type:"date",value:N,onChange:D=>{u(D.target.value),h(S,D.target.value)},min:S,className:"w-full mt-1 px-3 py-2 text-sm border border-orange-600 rounded-lg focus:ring-2 focus:ring-blue-400"})]})]})}),w&&e.jsx("p",{className:"px-4 text-red-600 text-xs",children:w}),e.jsx("div",{className:"bg-gray-50 shadow-lg rounded-xl py-6 px-2 space-y-4 border-l-4 border-pink-500 mt-6",children:e.jsx(Et,{accountId:a,fromDate:S,toDate:N})})]})}function Ut(r){const[n,a]=t.useState([]),[i,s]=t.useState(!1),[l,d]=t.useState(null);return t.useEffect(()=>{if(!r)return;(async()=>{s(!0),d(null);try{const{data:b}=await y.get(`http://localhost:3000/api/loanTransactions/transactions/${r}`),x=Bt(b);a(x)}catch(b){console.error(b),d("Failed to fetch cash‑book data.")}finally{s(!1)}})()},[r]),{loanLedger:n,loading:i,error:l}}function Bt(r){const n=[];for(const l of r)new Date(l.trxDate),n.push(l);let a=[],i=0;const s=n.sort((l,d)=>new Date(l.transactionDate)-new Date(d.transactionDate)).map(l=>{const d=l.isCredit,o=l.transactionType==="receipt"?l.installment:l.totalAmount;return i+=d?-o:o,_t(l,i)});return[...a,...s]}function _t(r,n){const a=r.isCredit,i=r.transactionType==="receipt"?r.installment:r.totalAmount;return{date:new Date(r.transactionDate).toLocaleDateString("en-GB"),trxId:r.trxBookNo,trxType:r.transactionType||"",interest:r.interest||0,debit:a?i.toLocaleString("en-US",{minimumFractionDigits:2}):"0.00",credit:a?"0.00":i.toLocaleString("en-US",{minimumFractionDigits:2}),balance:n.toLocaleString("en-US",{minimumFractionDigits:2}),createdAt:new Date(r.createdAt)}}function qt({loanId:r}){const{loanLedger:n,loading:a,error:i}=Ut(r);return r?a?e.jsx("p",{className:"text-gray-500 px-4 py-2",children:"Loading cash book..."}):i?e.jsx("p",{className:"text-red-500 px-4 py-2",children:i}):e.jsxs("div",{className:"w-full h-full text-sm text-gray-700 rounded bg-gray-50 shadow",children:[e.jsxs("div",{className:"hidden md:grid grid-cols-[100px_120px_120px_280px_120px_120px_120px] font-semibold bg-gray-200 px-4 py-2",children:[e.jsx("span",{children:"Date"}),e.jsx("span",{children:"Reference"}),e.jsx("span",{children:"Type"}),e.jsx("span",{className:"text-right",children:"Interest"}),e.jsx("span",{className:"text-right",children:"Debit"}),e.jsx("span",{className:"text-right",children:"Credit"}),e.jsx("span",{className:"text-right",children:"Balance"})]}),e.jsx("div",{className:"overflow-y-auto max-h-[60vh]",children:n.length===0?e.jsx("p",{className:"text-sm text-gray-500 px-4 py-2",children:"No Transaction Records available."}):e.jsx("div",{className:"text-sm text-gray-800",children:n.map((s,l)=>e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[100px_120px_120px_280px_120px_120px_120px] px-4 py-2 border-b border-gray-200 hover:bg-gray-100 gap-1 md:gap-0",children:[e.jsxs("div",{className:"flex justify-start gap-4 md:hidden",children:[e.jsx("span",{children:s.date}),e.jsx("span",{children:s.trxId}),e.jsx("span",{children:s.trxType})]}),e.jsxs("div",{className:"flex justify-end gap-4 md:hidden",children:[e.jsx("span",{className:"text-right text-gray-600",children:s.interest>"0"?s.interest:"-"}),e.jsx("span",{className:`text-right ${s.debit==="0.00"?"text-green-600":"text-red-600"}`,children:s.debit==="0.00"?s.credit:s.debit}),e.jsx("span",{className:`text-right ${s.balance>"0.00"?"text-gray-600":"text-red-600"}`,children:s.balance})]}),e.jsx("span",{className:"hidden md:block",children:s.date}),e.jsx("span",{className:"hidden md:block",children:s.trxId}),e.jsx("span",{className:"hidden md:block",children:s.trxType}),e.jsx("span",{className:"hidden md:block text-right",children:s.interest>"0"?s.interest:"—"}),e.jsx("span",{className:"hidden md:block text-right",children:s.debit==="0.00"?"—":s.debit}),e.jsx("span",{className:"hidden md:block text-right",children:s.credit==="0.00"?"—":s.credit}),e.jsx("span",{className:"hidden md:block text-right",children:s.balance})]},`${s.trxId}-${l}`))})})]}):e.jsx("p",{className:"text-gray-500 px-4 py-2",children:"No account selected"})}function zt(){const[r,n]=t.useState(""),[a,i]=t.useState({}),[s,l]=t.useState([]),[d,o]=t.useState(""),[b,x]=t.useState(!1),[p,c]=t.useState(!1),[S,g]=t.useState({}),[N,u]=t.useState([]),w={"Welfare Loan":"සුභසාධන ණය","Short Term Loan":"කෙටි කාලීන ණය","Long Term Loan":"දිගු කාලීන ණය","Project Loan":"ව්යාපෘති ණය"},v=async h=>{var A,D;if(!(!h||h==="0")){x(!0);try{const f=await y.get(`http://localhost:3000/api/loanMaster/customer/${h}`);if(f.data){const C=f.data.map(E=>({...E,loanTypeSinhala:w[E.loanType]||E.loanType}));l(C);const O=await y.get(`http://localhost:3000/api/customer/${h}`);O.data&&i(O.data)}}catch(f){m.error(((D=(A=f.response)==null?void 0:A.data)==null?void 0:D.message)||"Applicant not found")}finally{x(!1)}}};return t.useEffect(()=>{(async()=>{var A,D;if(d){c(!0);try{const f=await y.get(`http://localhost:3000/api/loanMaster/loan/${d}`);if(f.data){try{const C=r,O=d,E="receipt",W=await y.get(`http://localhost:3000/api/loanTransactions/transactions/${O}`);W.data?u(W.data):u({})}catch(C){console.error("Error fetching last transaction:",C)}g(f.data)}else g({}),u([])}catch(f){m.error(((D=(A=f.response)==null?void 0:A.data)==null?void 0:D.message)||"Loan details not found")}finally{c(!1)}}})()},[d]),e.jsxs("div",{className:"flex flex-col  max-w-5xl mx-auto min-h-screen",children:[e.jsx("div",{className:"sticky top-0 z-30 bg-gradient-to-r from-blue-500 to-indigo-500 text-white p-4 shadow-md flex flex-col md:flex-row md:items-center md:justify-between gap-3 rounded-b-lg",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl font-bold",children:"💵 ණය ලෙජරය"}),e.jsx("p",{className:"text-xs opacity-90",children:"සියලුම ණය ගනුදෙනු සහ ශේෂයන් නිරීක්ෂණය කරන්න"})]})}),e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-indigo-500 mt-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"සාමාජික අංකය"}),e.jsx("input",{type:"text",className:"w-full border border-gray-300 rounded-lg p-3 text-center focus:outline-none focus:ring-2 focus:ring-purple-500",placeholder:"000",maxLength:3,value:r,onChange:async h=>{const A=h.target.value;n(A),A.length===3&&await v(A)}})]}),b?e.jsx(ne,{}):s&&s.length>0?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"සාමාජිකයාගේ නම"}),e.jsx("div",{className:"w-full bg-purple-50 border border-purple-200 rounded-lg p-3 text-center font-medium text-purple-700",children:(a==null?void 0:a.name)||""})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"ණය ගිණුම තෝරා ගන්න"}),e.jsxs("select",{className:"w-full p-3 rounded-lg border border-gray-300 bg-white focus:outline-none focus:ring-2 focus:ring-purple-500",value:d,onChange:h=>o(h.target.value),children:[e.jsx("option",{value:"",children:"Select Loan Type"}),s.map(h=>e.jsx("option",{value:h.loanId||h.loanId,children:h.loanTypeSinhala},h.id||h._id))]})]})]}):e.jsx("p",{className:"text-center text-gray-500",children:"ණය ගිණුමක් සොයාගත නොහැක."})]}),p?e.jsx(ne,{}):N&&N.length>0?e.jsxs("div",{className:"bg-white shadow-lg rounded-xl p-6 space-y-4 border-l-4 border-indigo-500 mt-6",children:[e.jsxs("div",{className:"flex justify-between w-full bg-green-50 border border-green-200 rounded-lg p-3 text-center font-medium text-green-700",children:[e.jsx("label",{className:"block text-sm font-medium",children:"ගිණුම් ශේෂය"}),"Rs. ",V(S==null?void 0:S.dueAmount)||""]}),e.jsx(qt,{loanId:S.loanId})]}):e.jsx("p",{className:"text-center text-gray-500 mt-6",children:"ණය ගනුදෙනු සොයාගත නොහැක."})]})}function Ht({images:r=[]}){const[n,a]=t.useState(0),i=t.useRef(null),s=l=>{i.current&&i.current.scrollBy({[l==="left"||l==="right"?"left":"top"]:l==="up"||l==="left"?-100:100,behavior:"smooth"})};return e.jsxs("div",{className:"w-full md:w-[600px] flex flex-col md:flex-row overflow-hidden",children:[e.jsx("div",{className:"w-full md:w-auto aspect-square md:aspect-auto md:h-[500px] rounded-2xl",children:e.jsx("img",{src:r[n],alt:`Image ${n+1}`,className:"w-full h-full object-cover rounded-xl"})}),e.jsxs("div",{className:"w-full md:w-[100px] h-[100px] md:h-[500px] relative flex md:flex-col items-center justify-center flex-none",children:[e.jsx("button",{className:"hidden md:block absolute top-2 z-10 bg-white p-1 rounded-full shadow-md",onClick:()=>s("up"),children:"↑"}),e.jsx("button",{className:"md:hidden absolute left-2 z-10 bg-white p-1 rounded-full shadow-md",onClick:()=>s("left"),children:"←"}),e.jsx("div",{ref:i,className:"flex w-full h-full overflow-x-auto md:overflow-y-auto px-4 py-2 space-x-2 md:flex-col md:space-x-0 md:space-y-2",children:r.map((l,d)=>e.jsx("img",{src:l,onClick:()=>a(d),className:"cursor-pointer object-cover rounded-xl transition-all w-[60px] h-[60px] md:w-[80px] md:h-[80px] "+(d===n?"border-4 border-yellow-400":"hover:border-4 hover:border-yellow-300"),alt:`Thumbnail ${d+1}`},d))}),e.jsx("button",{className:"hidden md:block absolute bottom-2 z-10 bg-white p-1 rounded-full shadow-md",onClick:()=>s("down"),children:"↓"}),e.jsx("button",{className:"md:hidden absolute right-2 z-10 bg-white p-1 rounded-full shadow-md",onClick:()=>s("right"),children:"→"})]})]})}function xe(){let r=localStorage.getItem("cart");return r=JSON.parse(r),r==null&&(r=[],localStorage.setItem("cart",JSON.stringify(r))),r}function Vt(r){const a=xe().filter(i=>i.productId!=r);localStorage.setItem("cart",JSON.stringify(a))}function Ce(r,n){let a=xe(),i=a.findIndex(s=>s.productId==r.productId);if(i==-1)a[a.length]={productId:r.productId,name:r.name,image:r.image,altName:r.altName,description:r.description,price:r.price,labelledPrice:r.labelledPrice,qty:1};else{let s=a[i].qty+n;if(s<=0){s=0;return}else a[i].qty=s}localStorage.setItem("cart",JSON.stringify(a))}function Wt(){return xe().reduce((a,i)=>a+i.labelledPrice*i.qty,0)}function Yt(){return xe().reduce((a,i)=>a+(i.labelledPrice-i.price)*i.qty,0)}function Jt(){return xe().reduce((a,i)=>a+i.price*i.qty,0)}function Kt(){return(xe()||[]).reduce((a,i)=>{const s=parseFloat(i.price)||0,l=parseInt(i.qty)||0;return a+s*l},0)}function Xt(){const n=rt().Id,[a,i]=t.useState("loading"),[s,l]=t.useState(null),d=ee();return t.useEffect(()=>{y.get("http://localhost:3000/api/products/"+n).then(o=>{l(o.data),i("success")}).catch(o=>{i("error"),m.error("Error fetching product details")})},[]),e.jsxs(e.Fragment,{children:[a=="success"&&e.jsxs("div",{className:"w-full h-full flex flex-col md:flex-row",children:[e.jsxs("h1",{className:"md:hidden my-8 w-full text-center text-2xl font-semibold text-secondary",children:[s.name,s.altName.map((o,b)=>e.jsx("span",{className:"w-full text-center text-2xl font-semibold text-gray-600",children:" | "+o},b))]}),e.jsx("div",{className:"w-full md:w-[50%] h-full flex justify-center items-center",children:e.jsx(Ht,{images:s.image})}),e.jsx("div",{className:"w-full md:w-[50%] h-full flex justify-center items-center",children:e.jsxs("div",{className:"w-[400px] h-[400px] flex flex-col item-center",children:[e.jsxs("h1",{className:"hidden md:block w-full text-center text-2xl font-semibold text-secondary",children:[s.name,s.altName.map((o,b)=>e.jsx("span",{className:"w-full text-center text-2xl font-semibold text-gray-600",children:" | "+o},b))]}),e.jsx("h1",{className:"w-full text-center my-2 text-sm font-semibold text-gray-600",children:s.productId}),e.jsx("h1",{className:"w-full text-center my-2 text-md font-semibold text-gray-600",children:s.description}),s.labelledPrice>s.price?e.jsxs("div",{className:"w-full flex justify-center items-center mt-4",children:[e.jsx("span",{className:"text-4xl text-gray-900",children:"Rs."+s.price.toFixed(2)}),e.jsxs("span",{className:"text-2xl text-gray-500 line-through ml-6",children:["Rs.",s.labelledPrice.toFixed(2)]})]}):e.jsx("span",{className:"text-4xl text-center text-gray-900 mt-4",children:"Rs."+s.price.toFixed(2)}),e.jsxs("div",{className:"w-full flex flex-col md:flex-row justify-center item-center mt-10",children:[e.jsx("button",{className:"md:w-full my-2 mx-4 cursor-pointer bg-green-600 text-sm text-white py-2 rounded-md hover:bg-green-700 active:bg-green-800",onClick:()=>{d("/checkout",{state:{cart:[{productId:s.productId,name:s.name,image:s.image,altName:s.altName,description:s.description,price:s.price,labelledPrice:s.labelledPrice,qty:1}]}})},children:"Buy Now"}),e.jsx("button",{className:"md:w-full my-2 mx-4 cursor-pointer bg-blue-600 text-sm text-white py-2 rounded-md hover:bg-blue-700 active:bg-blue-800",onClick:()=>{Ce(s,1),m.success("Added to cart")},children:"Add to Cart"})]})]})})]}),a=="loading"&&e.jsx(ne,{})]})}function Zt(){const[r,n]=t.useState(xe()),[a,i]=t.useState({}),s=l=>{i(d=>({...d,[l]:!d[l]}))};return e.jsxs("div",{className:"bg-gray-200 w-[95%] md:w-full md:h-full flex flex-col md:flex-row justify-between items-center md:pl-25 md:pr-25 pt-1 md:pt-4 pb-1 md:pb-4",children:[e.jsx("div",{className:"bg-gray-100 w-[95%] md:w-[65%] md:h-full flex flex-col items-left rounded-md p-1 md:p-6 md:overflow-y-scroll",children:r.map(l=>e.jsxs("div",{className:"w-[100%] md:h-[115px] bg-white my-1 rounded-md flex flex-col md:flex-row justify-between items-center p-2",children:[e.jsx("div",{className:"p-4",children:e.jsx("input",{type:"checkbox",checked:!!a[l.productId],onChange:()=>s(l.productId),className:"w-5 h-5 rounded-full border-2 cursor-pointer hover:border-red-600"})}),e.jsx("div",{className:"md:w-[15%] h-full",children:e.jsx("img",{src:l.image[0],className:"w-[100px] h-[100px] object-cover rounded-md"})}),e.jsx("div",{className:"w-full md:w-[65%] h-full flex flex-col justify-top item-center md:items-start ml-4 mr-4",children:e.jsxs("div",{className:"w-full h-full flex flex-col justify-top",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-1xl text-secondary font-semibold flex justify-center md:justify-start",children:l.name}),e.jsx("h1",{className:"text-sm text-gray-600 font-normal flex justify-center md:justify-start",children:l.productId})]}),e.jsxs("div",{className:"w-full flex flex-col md:flex-row md:justify-between items-center",children:[l.labelledPrice>l.price?e.jsxs("div",{children:[e.jsxs("span",{className:"text-lg font-semibold text-secondary",children:["Rs.",l.price.toFixed(2)]}),e.jsxs("span",{className:"text-md mx-2 text-gray-500 line-through",children:["Rs.",l.labelledPrice.toFixed(2)]})]}):e.jsxs("span",{className:"text-lg font-semibold text-accent",children:["Rs.",l.price.toFixed(2)]}),e.jsxs("span",{className:"text-sm text-gray-600 font-semibold mr-2",children:["Rs.",(l.price*l.qty).toFixed(2)]})]})]})}),e.jsxs("div",{className:"w-[100px] h-[100px] flex flex-col justify-top items-center md:items-end space-y-4",children:[e.jsx("button",{className:"text-2xl cusor-pointer hover:bg-red-600 hover:text-white rounded-full",onClick:()=>{Vt(l.productId),n(xe()),m.success("Item removed from cart")},children:e.jsx(Ee,{})}),e.jsxs("div",{className:"w-[100px] h-[30px] flex flex-row justify-center items-center border-1 border-gray-200 rounded-xl p-2",children:[e.jsx("button",{className:"text-1xl mx-1 rounded-xl hover:bg-blue-400 active:bg-blue-600 p-2 text-gray-600 font-semibold cursor-pointer aspect-round",onClick:()=>{l.qty>0&&(Ce(l,-1),n(xe()))},children:e.jsx(Oe,{})}),e.jsx("h1",{className:"text-1xl mx-1 text-secondary font-semibold h-full flex items-center",children:l.qty}),e.jsx("button",{className:"text-1xl mx-1 rounded-xl hover:bg-blue-400 active:bg-blue-600 p-2 text-gray-600 font-semibold cursor-pointer aspect-square",onClick:()=>{Ce(l,1),n(xe())},children:e.jsx(Ue,{})})]})]})]},l.productId))}),e.jsxs("div",{className:"bg-gray-100 w-[95%] md:w-[33%] h-full mt-4 md:mt-0 mb-4 md:mb-0flex flex-col rounded-md p-8",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Summary"}),e.jsxs("div",{className:"w- full flex justify-between pt-8",children:[e.jsx("p",{className:"text-sm font-normal text-gray-400",children:"Total Items:"}),e.jsxs("p",{className:"text-sm font-normal text-gray-900",children:[" ",r.length]})]}),e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsx("p",{className:"text-sm font-normal text-gray-400",children:"Items Total:"}),e.jsxs("span",{className:"text-sm font-normal text-gray-400 line-through",children:["Rs.",Wt().toFixed(2)]})]}),e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-400",children:"Items Discount:"}),e.jsxs("p",{className:"text-sm font-nrmal text-red-600",children:["- Rs.",Yt().toFixed(2)," "]})]}),e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Sub Total:"}),e.jsxs("p",{className:"text-sm font-semibold text-gray-900",children:["Rs.",Jt().toFixed(2)]})]}),e.jsxs("div",{className:"w-full flex justify-between pt-2",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Shipping:"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:"Rs.00.00"})]}),e.jsxs("div",{className:"w-full flex justify-between pt-4",children:[e.jsx("p",{className:"text-lg font-semibold text-gray-900",children:"Estimated Total:"}),e.jsxs("p",{className:"text-lg font-semibold text-gray-900",children:["Rs.",Kt().toFixed(2)]})]}),e.jsx("div",{className:"w-full flex justify-center",children:e.jsx(j,{to:"/checkout",state:{cart:Object.values(a).some(Boolean)?r.filter(l=>a[l.productId]):r},className:"w-full bg-red-600 text-center text-white hover:bg-red-700 cursor-pointer text-white font-semibold py-2 px-4 rounded-md mt-8",children:"Checkout"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-600 mt-4",children:"* Shipping and taxes are calculated at checkout."})]})]})}function Qt(){const r=ee(),n=be(),[a,i]=t.useState(()=>{var w;return(((w=n.state)==null?void 0:w.cart)||[]).map(v=>{const h=v.productInfo||v;return{productId:h.productId,name:h.name,description:h.description||"",image:Array.isArray(h.image)?h.image:[h.image||""],altName:Array.isArray(h.altName)?h.altName:[h.altName||""],labelledPrice:h.labelledPrice||h.price,price:h.price,qty:h.qty||h.quantity||1}})}),[s,l]=t.useState(""),[d,o]=t.useState(""),b=()=>a.reduce((u,w)=>u+w.labelledPrice*w.qty,0),x=()=>a.reduce((u,w)=>u+(w.labelledPrice-w.price)*w.qty,0),p=()=>a.reduce((u,w)=>u+w.price*w.qty,0),c=()=>a.reduce((u,w)=>u+w.price*w.qty,0),S=u=>{i(a.filter((w,v)=>v!==u))},g=(u,w)=>{const v=[...a];v[u].qty=Math.max(1,v[u].qty+w),i(v)},N=async()=>{const u=localStorage.getItem("token");if(!u){m.error("Please login first");return}if(!s||!d){m.error("Please enter phone number and address");return}if(a.length===0){m.error("Your cart is empty");return}const w={phone:s,address:d,products:a.map(v=>({productInfo:{productId:v.productId,name:v.name,altNames:Array.isArray(v.altName)?v.altName:[v.altName],quantity:v.qty,description:v.description,price:v.price,images:Array.isArray(v.image)?v.image:[v.image],labelledPrice:v.labelledPrice}}))};try{await y.post("http://localhost:3000/api/order",w,{headers:{Authorization:"Bearer "+u}}),m.success("Order placed successfully!"),r("/products")}catch{m.error("Error placing order")}};return e.jsxs("div",{className:"bg-gray-200 w-[95%] md:w-full md:h-full flex flex-col md:flex-row justify-between items-center p-1 md:p-4",children:[e.jsx("div",{className:"bg-gray-100 w-full md:w-[65%] h-full flex flex-col rounded-md p-1 md:p-6 md:overflow-y-scroll",children:a.map((u,w)=>e.jsxs("div",{className:"w-full h-full md:h-[115px] bg-white my-1 rounded-md flex flex-col md:flex-row md:justify-between items-center p-2",children:[e.jsx("div",{className:"w-[15%] h-full ml-4",children:e.jsx("img",{src:u.image[0],alt:u.image[0],className:"w-[100px] h-[100px] object-cover rounded-md"})}),e.jsxs("div",{className:"w-full md:w-[65%] h-full flex flex-col justify-top item-center md:items-start ml-4 mr-4",children:[e.jsx("h1",{className:"text-1xl text-secondary font-semibold flex justify-center md:justify-start",children:u.name}),e.jsx("p",{className:"text-xs text-gray-600 flex justify-center md:justify-start",children:u.productId}),e.jsxs("div",{className:"w-full flex flex-col md:flex-row md:justify-between items-center",children:[u.labelledPrice>u.price?e.jsxs("div",{children:[e.jsxs("span",{className:"text-lg font-semibold text-secondary ",children:["Rs.",u.price.toFixed(2)]}),e.jsxs("span",{className:"text-md mx-2 text-gray-500 line-through",children:["Rs.",u.labelledPrice.toFixed(2)]})]}):e.jsxs("span",{className:"text-lg font-semibold text-accent",children:["Rs.",u.price.toFixed(2)]}),e.jsxs("span",{className:"text-sm font-semibold text-gray-600",children:["Rs.",(u.price*u.qty).toFixed(2)]})]})]}),e.jsxs("div",{className:"w-[100px] h-[100px] flex flex-col justify-between items-center md:items-end space-y-2",children:[e.jsx("button",{className:"text-2xl hover:bg-red-600 hover:text-white rounded-full",onClick:()=>S(w),children:e.jsx(Ee,{})}),e.jsxs("div",{className:"flex border rounded-xl p-1 items-center",children:[e.jsx("button",{onClick:()=>g(w,-1),className:"p-1 hover:bg-blue-400 rounded-xl",children:e.jsx(Oe,{})}),e.jsx("span",{className:"mx-2",children:u.qty}),e.jsx("button",{onClick:()=>g(w,1),className:"p-1 hover:bg-blue-400 rounded-xl",children:e.jsx(Ue,{})})]})]})]},u.productId||w))}),e.jsxs("div",{className:"bg-gray-100 w-full md:w-[33%] h-full mt-4 md:mt-0 mb-4 md:mb-0 flex flex-col rounded-md p-8",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900",children:"Summary"}),e.jsxs("div",{className:"pt-8 space-y-2",children:[e.jsx(we,{label:"Total Items",value:a.length}),e.jsx(we,{label:"Items Total",value:`Rs.${b().toFixed(2)}`,strike:!0}),e.jsx(we,{label:"Items Discount",value:`- Rs.${x().toFixed(2)}`,highlight:!0}),e.jsx(we,{label:"Sub Total",value:`Rs.${p().toFixed(2)}`,bold:!0}),e.jsx(we,{label:"Shipping",value:"Rs.00.00",bold:!0}),e.jsx(we,{label:"Estimated Total",value:`Rs.${c().toFixed(2)}`,bold:!0,large:!0})]}),e.jsx("input",{className:"w-full text-sm rounded-md border-2 border-gray-200 py-2 px-4 mt-8",type:"text",placeholder:"Phone Number",value:s,onChange:u=>l(u.target.value)}),e.jsx("input",{className:"w-full text-sm rounded-md border-2 border-gray-200 py-2 px-4 mt-4",type:"text",placeholder:"Address",value:d,onChange:u=>o(u.target.value)}),e.jsx("button",{className:"bg-green-600 hover:bg-green-700 text-white font-semibold py-2 px-4 rounded-md mt-8",disabled:a.length===0,onClick:N,children:"Place Order"}),e.jsx("p",{className:"text-sm font-semibold text-gray-600 mt-4",children:"* Shipping and taxes are calculated at checkout."})]})]})}function we({label:r,value:n,strike:a,bold:i,highlight:s,large:l}){const d="text-sm",o=`${d} ${i?"font-semibold":"font-normal"} text-gray-400`,b=`${d} ${i?"font-semibold":"font-normal"} ${s?"text-red-600":"text-gray-900"} ${a?"line-through":""} ${l?"text-lg":""}`;return e.jsxs("div",{className:"w-full flex justify-between",children:[e.jsx("p",{className:o,children:r}),e.jsx("p",{className:b,children:n})]})}function es(){return e.jsxs(t.Fragment,{children:[e.jsxs("title",{children:[e.jsx("title",{children:"About | Thewana Shakthi Development Foundation"}),e.jsx("meta",{name:"description",content:"Learn about Thewana Shakthi Development Foundation’s mission to empower members through social, financial, and personal development."})]}),e.jsxs("section",{className:"relative w-full h-[50vh] bg-gradient-to-r from-indigo-700 to-purple-700 flex items-center justify-center overflow-hidden",children:[e.jsx(de.img,{src:"/about-hero.jpg",alt:"Community development",className:"absolute inset-0 w-full h-full object-cover mix-blend-overlay opacity-50",initial:{scale:1.2},animate:{scale:1},transition:{duration:1}}),e.jsx(de.h1,{className:"relative text-3xl md:text-5xl font-extrabold text-white drop-shadow-lg text-center",initial:{opacity:0,y:60},animate:{opacity:1,y:0},transition:{delay:.3},children:"About Thewana Shakthi Development Foundation"})]}),e.jsxs("section",{className:"max-w-6xl mx-auto px-6 py-16 grid md:grid-cols-2 gap-10",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold mb-4",children:"Our Mission"}),e.jsx("p",{className:"text-lg leading-relaxed text-gray-700",children:"To uplift members by creating opportunities for social, financial, and personal development—empowering individuals to live with dignity, purpose, and resilience."})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold mb-4",children:"Our Vision"}),e.jsx("p",{className:"text-lg leading-relaxed text-gray-700",children:"To build a strong, united community where every member has the support and resources to achieve their fullest potential and contribute meaningfully to society."})]})]}),e.jsx("section",{className:"bg-gray-50 py-12",children:e.jsx("div",{className:"max-w-5xl mx-auto grid sm:grid-cols-3 text-center gap-8",children:[{value:"20+",label:"Years of Service"},{value:"10K+",label:"Active Members"},{value:"150+",label:"Community Projects"}].map(({value:r,label:n})=>e.jsxs("div",{children:[e.jsx("p",{className:"text-4xl font-extrabold text-indigo-700",children:r}),e.jsx("p",{className:"mt-2 text-gray-600",children:n})]},n))})}),e.jsxs("section",{className:"max-w-6xl mx-auto px-6 py-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-10",children:"Our Core Values"}),e.jsx("div",{className:"grid md:grid-cols-3 gap-8",children:[{icon:e.jsx(lt,{size:40}),title:"Compassion",desc:"We extend kindness and support to those in need."},{icon:e.jsx(nt,{size:40}),title:"Empowerment",desc:"We help individuals build confidence and skills for growth."},{icon:e.jsx(ot,{size:40}),title:"Progress",desc:"We embrace innovation to drive positive change in communities."},{icon:e.jsx(ct,{size:40}),title:"Sustainability",desc:"We ensure our initiatives create lasting and meaningful impact."},{icon:e.jsx(it,{size:40}),title:"Community",desc:"We believe in unity, collaboration, and shared responsibility."}].map(({icon:r,title:n,desc:a})=>e.jsxs(de.div,{className:"bg-white rounded-2xl p-8 shadow-md text-center",initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{duration:.4},children:[e.jsx("div",{className:"flex justify-center mb-4 text-indigo-700",children:r}),e.jsx("h3",{className:"text-xl font-semibold mb-2",children:n}),e.jsx("p",{className:"text-gray-600",children:a})]},n))})]}),e.jsx("section",{className:"w-full bg-indigo-700 text-white py-16",children:e.jsxs("div",{className:"max-w-full mx-auto text-center px-4",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold mb-4",children:"Be Part of the Change"}),e.jsx("p",{className:"mb-8 text-lg max-w-2xl mx-auto",children:"Join Thewana Shakthi Development Foundation as a member, volunteer, or supporter—and help us uplift lives together."}),e.jsxs("div",{className:"flex flex-col sm:flex-row justify-center gap-4",children:[e.jsx(de.button,{whileTap:{scale:.95},className:"px-6 py-3 rounded-2xl font-semibold bg-white text-indigo-700 shadow",onClick:()=>window.location.href="/register",children:"Join Us"}),e.jsx(de.button,{whileTap:{scale:.95},className:"px-6 py-3 rounded-2xl font-semibold border border-white shadow",onClick:()=>window.location.href="/contact",children:"Contact Us"})]})]})})]})}function He(){const[r,n]=t.useState({name:"",email:"",subject:"",message:""}),[a,i]=t.useState(!1),[s,l]=t.useState(!1),[d,o]=t.useState(""),b=c=>n({...r,[c.target.name]:c.target.value}),x=async c=>{c.preventDefault(),i(!0),o("");try{if(!(await fetch("/api/contact",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(r)})).ok)throw new Error("Network response was not ok");l(!0),n({name:"",email:"",subject:"",message:""})}catch(S){console.error(S),o("Something went wrong. Please try again.")}finally{i(!1)}},p=({label:c,name:S,type:g="text",textarea:N=!1})=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsx("label",{htmlFor:S,className:"font-medium",children:c}),N?e.jsx("textarea",{id:S,name:S,rows:5,className:"p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring focus:ring-indigo-300",value:r[S],onChange:b,required:!0}):e.jsx("input",{id:S,name:S,type:g,className:"p-3 rounded-xl border border-gray-300 focus:outline-none focus:ring focus:ring-indigo-300",value:r[S],onChange:b,required:!0})]});return e.jsxs("main",{className:"min-h-screen flex flex-col",children:[e.jsxs("section",{className:"relative h-[40vh] bg-indigo-700 flex items-center justify-center overflow-hidden",children:[e.jsx("img",{src:"/contact-hero.jpg",alt:"Contact us",className:"absolute inset-0 w-full h-full object-cover opacity-50 mix-blend-overlay"}),e.jsx("h1",{className:"relative text-4xl md:text-5xl font-extrabold text-white drop-shadow-lg text-center",children:"Get in Touch"})]}),e.jsxs("section",{className:"flex-1 max-w-6xl mx-auto px-6 py-16 grid lg:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"flex flex-col gap-8",children:[e.jsx("h2",{className:"text-3xl font-bold",children:"We’d love to hear from you"}),e.jsx("p",{className:"text-gray-700",children:"Whether you have questions about our programs, want to volunteer, or wish to support our initiatives—our team is ready to help!"}),e.jsxs("ul",{className:"space-y-6",children:[e.jsxs("li",{className:"flex items-start gap-4",children:[e.jsx(dt,{className:"text-2xl text-indigo-600 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Email us"}),e.jsx("a",{href:"mailto:info@thewanashakthi.org",className:"text-indigo-600 hover:underline",children:"info@thewanashakthi.org"})]})]}),e.jsxs("li",{className:"flex items-start gap-4",children:[e.jsx(xt,{className:"text-2xl text-indigo-600 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Call us"}),e.jsx("a",{href:"tel:+94111234567",className:"text-indigo-600 hover:underline",children:"+94 11 123 4567"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Mon–Fri, 9 AM – 5 PM"})]})]}),e.jsxs("li",{className:"flex items-start gap-4",children:[e.jsx(mt,{className:"text-2xl text-indigo-600 shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold",children:"Visit us"}),e.jsxs("address",{className:"not-italic",children:["Pothukoladeniya,",e.jsx("br",{}),"Kegalle, Sri Lanka"]})]})]})]}),e.jsx("div",{className:"rounded-xl overflow-hidden shadow-lg",children:e.jsx("iframe",{title:"Thewana Shakthi map",src:"https://maps.google.com/maps?q=colombo%2007&t=&z=13&ie=UTF8&iwloc=&output=embed",loading:"lazy",className:"w-full h-64 border-0"})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6",children:"Send us a message"}),s&&e.jsxs("p",{className:"flex items-center gap-2 mb-4 text-green-700 bg-green-50 border border-green-200 p-3 rounded-lg",children:[e.jsx(ut,{className:"text-xl"})," Thank you! We’ll get back to you soon."]}),d&&e.jsx("p",{className:"mb-4 text-red-600 bg-red-50 border border-red-200 p-3 rounded-lg",children:d}),e.jsxs("form",{onSubmit:x,className:"space-y-5",children:[e.jsx(p,{label:"Name",name:"name"}),e.jsx(p,{label:"Email",name:"email",type:"email"}),e.jsx(p,{label:"Subject",name:"subject"}),e.jsx(p,{label:"Message",name:"message",textarea:!0}),e.jsx("button",{type:"submit",disabled:a,className:"flex items-center justify-center gap-2 w-full py-3 px-6 bg-indigo-600 text-white font-semibold rounded-xl shadow hover:bg-indigo-700 disabled:opacity-50",children:a?e.jsxs(e.Fragment,{children:["Sending...",e.jsx($e,{className:"animate-pulse"})]}):e.jsxs(e.Fragment,{children:["Send Message",e.jsx($e,{})]})})]})]})]})]})}function ts(){const[r,n]=t.useState([]),[a,i]=t.useState(!0);return t.useEffect(()=>{a&&(async()=>{})()},[a]),e.jsxs(t.Fragment,{children:[e.jsxs("section",{className:"relative w-full h-[60vh] sm:h-[70vh] bg-gradient-to-r from-indigo-600 to-purple-700 flex items-center justify-center overflow-hidden",children:[e.jsx(de.img,{src:"/foundation-banner.jpg",alt:"Foundation banner",className:"absolute inset-0 w-full h-full object-cover opacity-40",initial:{scale:1.2},animate:{scale:1},transition:{duration:1}}),e.jsxs("div",{className:"relative text-center text-white px-4",children:[e.jsx(de.h1,{className:"text-3xl sm:text-5xl font-extrabold drop-shadow-lg",initial:{opacity:0,y:60},animate:{opacity:1,y:0},transition:{delay:.3},children:"Thewana Shakthi Development Foundation"}),e.jsx(de.p,{className:"mt-4 max-w-xl mx-auto text-base sm:text-lg",initial:{opacity:0,y:40},animate:{opacity:1,y:0},transition:{delay:.5},children:"Empowering members through social, financial, and personal development for a brighter future."}),e.jsxs(de.div,{className:"mt-6 flex flex-col sm:flex-row justify-center gap-4",initial:{opacity:0},animate:{opacity:1},transition:{delay:.7},children:[e.jsx(j,{to:"/programs",className:"px-6 py-3 bg-white text-indigo-700 font-semibold rounded-full shadow hover:bg-gray-100",children:"Explore Programs"}),e.jsx(j,{to:"/about",className:"px-6 py-3 border border-white font-semibold rounded-full hover:bg-white hover:text-indigo-700",children:"Learn More"})]})]})]}),e.jsx("section",{className:"bg-white py-12",children:e.jsx("div",{className:"max-w-6xl mx-auto grid sm:grid-cols-3 gap-8 text-center",children:[{icon:e.jsx(ht,{size:36}),title:"Social Development",desc:"Community programs to uplift and unite members."},{icon:e.jsx(pt,{size:36}),title:"Financial Growth",desc:"Guidance, training, and opportunities for stability."},{icon:e.jsx(gt,{size:36}),title:"Personal Support",desc:"Mentorship and education for personal empowerment."}].map(({icon:s,title:l,desc:d})=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"text-indigo-600",children:s}),e.jsx("h3",{className:"mt-3 font-bold",children:l}),e.jsx("p",{className:"mt-1 text-gray-600 text-sm text-center px-4",children:d})]},l))})}),e.jsxs("section",{className:"max-w-6xl mx-auto px-4 sm:px-6 py-16",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl font-bold text-center mb-10",children:"Our Key Programs"}),a?e.jsx("p",{className:"text-center",children:"Loading programs..."}):r.length===0?e.jsx("p",{className:"text-center text-gray-500",children:"No programs available at the moment."}):e.jsx("div",{className:"grid sm:grid-cols-2 md:grid-cols-3 gap-8",children:r.slice(0,3).map((s,l)=>e.jsx(de.article,{className:"bg-white rounded-2xl shadow-md overflow-hidden hover:shadow-lg transition-shadow",initial:{opacity:0,y:40},whileInView:{opacity:1,y:0},viewport:{once:!0},transition:{delay:l*.1},children:e.jsxs(j,{to:`/programs/${s.id}`,children:[e.jsx("img",{src:s.image[0],alt:s.title,className:"w-full h-48 object-cover"}),e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:"text-lg font-semibold",children:s.title}),e.jsx("p",{className:"mt-2 text-gray-600 text-sm",children:s.desc})]})]})},s.id))}),e.jsx("div",{className:"text-center mt-10",children:e.jsx(j,{to:"/programs",className:"inline-block px-8 py-3 border border-indigo-600 text-indigo-600 font-semibold rounded-full hover:bg-indigo-50",children:"View All Initiatives"})})]}),e.jsxs("section",{className:"w-full bg-indigo-700 text-white py-16 text-center",children:[e.jsx("h2",{className:"text-2xl sm:text-3xl md:text-4xl font-bold",children:"Join Thewana Shakthi Development Foundation"}),e.jsx("p",{className:"mt-4 max-w-2xl mx-auto px-4",children:"Become a member, volunteer, or supporter and be part of a mission to uplift lives and create lasting impact."}),e.jsx(j,{to:"/register",className:"mt-8 inline-block px-8 py-3 bg-white text-indigo-700 font-semibold rounded-full shadow hover:bg-gray-100",children:"Get Involved"})]})]})}function ss(){return e.jsxs("div",{className:"w-full min-h-screen flex flex-col",children:[e.jsx(Ct,{}),e.jsx("main",{className:"w-full flex-grow flex flex-col items-center px-4 py-6",children:e.jsx(Be,{})})]})}function as(){return e.jsx(Le,{children:e.jsxs(q,{path:"*",element:e.jsx(ss,{}),children:[e.jsx(q,{index:!0,element:e.jsx(At,{})}),e.jsx(q,{path:"members",element:e.jsx(Dt,{})}),e.jsx(q,{path:"apply-loan",element:e.jsx(Tt,{})}),e.jsx(q,{path:"approve-loan",element:e.jsx($t,{})}),e.jsx(q,{path:"grant-loan",element:e.jsx(Pt,{})}),e.jsx(q,{path:"receipts-loan",element:e.jsx(Ft,{})}),e.jsx(q,{path:"receipt-membership",element:e.jsx(Mt,{})}),e.jsx(q,{path:"cash-book",element:e.jsx(Ot,{})}),e.jsx(q,{path:"ledger-loan",element:e.jsx(zt,{})}),e.jsx(q,{path:"contact",element:e.jsx(He,{})}),e.jsx(q,{path:"overview/:Id",element:e.jsx(Xt,{})}),e.jsx(q,{path:"cart",element:e.jsx(Zt,{})}),e.jsx(q,{path:"checkout",element:e.jsx(Qt,{})}),e.jsx(q,{path:"*",element:e.jsx(Ae,{})})]})})}function rs(){const[r,n]=t.useState(!1),a=ee(),i=be(),s=localStorage.getItem("token"),l=localStorage.getItem("cart"),d=!!s;l&&JSON.parse(l).length;const o=localStorage.getItem("user"),b=()=>{localStorage.removeItem("token"),localStorage.removeItem("user"),a("/",{replace:!0})};return t.useEffect(()=>{n(!1)},[i.pathname]),e.jsxs("header",{className:"w-full h-[80px] shadow-2xl flex justify-center relative bg-white z-50",children:[e.jsx(Ie,{className:"h-full text-3xl md:hidden absolute left-4 cursor-pointer",onClick:()=>n(!0)}),e.jsx("img",{src:"/LogoTSDF.png",alt:"Logo",className:"w-[80px] h-[80px] object-cover cursor-pointer",onClick:()=>a("/")}),d?e.jsxs("nav",{className:"flex-1 hidden md:flex justify-center items-center",children:[e.jsx(j,{to:"/",className:"text-lg font-bold mx-3 hover:underline",children:"Home"}),e.jsx(j,{to:"/Gallery",className:"text-lg font-bold mx-3 hover:underline",children:"Gallery"}),e.jsx(j,{to:"/about",className:"text-lg font-bold mx-3 hover:underline",children:"About"}),e.jsx(j,{to:"/contact",className:"text-lg font-bold mx-3 hover:underline",children:"Contact"}),e.jsx(j,{to:"/profile",className:"text-lg font-bold mx-3 hover:underline",children:"Profile"}),e.jsx(j,{to:"/membership",className:"text-lg font-bold mx-3 hover:underline",children:"Membership Fee"}),e.jsx(j,{to:"/loan",className:"text-lg font-bold mx-3 hover:underline",children:"Loan"}),e.jsx(j,{to:"/apply-loan",className:"text-lg font-bold mx-3 hover:underline",children:"Apply Loan"}),e.jsx(j,{to:"/constitution",className:"text-lg font-bold mx-3 hover:underline",children:"Constitution"})]}):e.jsxs("nav",{className:"flex-1 hidden md:flex justify-center items-center",children:[e.jsx(j,{to:"/",className:"text-lg font-bold mx-3 hover:underline",children:"Home"}),e.jsx(j,{to:"/Gallery",className:"text-lg font-bold mx-3 hover:underline",children:"Gallery"}),e.jsx(j,{to:"/about",className:"text-lg font-bold mx-3 hover:underline",children:"About"}),e.jsx(j,{to:"/contact",className:"text-lg font-bold mx-3 hover:underline",children:"Contact"}),e.jsx(j,{to:"/login",className:"text-lg font-bold mx-3 hover:underline",children:"Login"})]}),e.jsxs("div",{className:"w-[200px] hidden md:flex justify-center items-center gap-4 pr-4",children:[e.jsx(Ge,{className:"text-2xl cursor-pointer"}),d?e.jsx("button",{onClick:b,className:"text-md font-semibold text-red-600",children:"Logout"}):e.jsx(j,{to:"/login",className:"text-md font-semibold text-blue-600",children:"Login"})]}),e.jsx("div",{className:`fixed inset-0 bg-black/60 md:hidden transition-opacity duration-300 ${r?"opacity-100":"opacity-0 pointer-events-none"}`,onClick:()=>n(!1),children:e.jsxs("aside",{className:`w-[280px] bg-white h-full shadow-xl transform transition-transform duration-300 ${r?"translate-x-0":"-translate-x-full"}`,onClick:x=>x.stopPropagation(),children:[e.jsxs("div",{className:"h-[80px] shadow flex items-center px-4",children:[e.jsx(Ie,{className:"text-3xl cursor-pointer",onClick:()=>n(!1)}),e.jsx("img",{src:"/LogoTSDF.png",alt:"Logo",className:"w-[60px] h-[60px] object-cover ml-auto cursor-pointer",onClick:()=>a("/")})]}),e.jsx("div",{children:e.jsxs("p",{className:"text-lg font-bold ml-4 mt-4",children:["Hello ",o?o.name:"Guest","!"]})}),d?e.jsxs("nav",{className:"flex flex-col items-start px-6 gap-4 mt-6",children:[e.jsx(j,{to:"/",className:"text-lg font-bold",onClick:()=>n(!1),children:"Home"}),e.jsx(j,{to:"/gallery",className:"text-lg font-bold",onClick:()=>n(!1),children:"Gallery"}),e.jsx(j,{to:"/about",className:"text-lg font-bold",onClick:()=>n(!1),children:"About"}),e.jsx(j,{to:"/contact",className:"text-lg font-bold",onClick:()=>n(!1),children:"Contact"}),e.jsx(j,{to:"/profile",className:"text-lg font-bold",onClick:()=>n(!1),children:"Profile"}),e.jsx(j,{to:"/membership",className:"text-lg font-bold",onClick:()=>n(!1),children:"Membership Fee"}),e.jsx(j,{to:"/loan",className:"text-lg font-bold",onClick:()=>n(!1),children:"Loan"}),e.jsx(j,{to:"/apply-loan",className:"text-lg font-bold",onClick:()=>n(!1),children:"Apply Loan"}),e.jsx(j,{to:"/constitution",className:"text-lg font-bold",onClick:()=>n(!1),children:"Constitution"})]}):e.jsxs("nav",{className:"flex flex-col items-start px-6 gap-4 mt-6",children:[e.jsx(j,{to:"/",className:"text-lg font-bold",onClick:()=>n(!1),children:"Home"}),e.jsx(j,{to:"/gallery",className:"text-lg font-bold",onClick:()=>n(!1),children:"Gallery"}),e.jsx(j,{to:"/about",className:"text-lg font-bold",onClick:()=>n(!1),children:"About"}),e.jsx(j,{to:"/contact",className:"text-lg font-bold",onClick:()=>n(!1),children:"Contact"})]}),d?e.jsx("button",{onClick:b,className:"px-6 text-lg font-bold text-red-600 mt-8",children:"Logout"}):e.jsx(j,{to:"/login",className:"px-6 text-lg font-bold text-blue-600 mt-8",children:"Login"})]})})]})}function ls(){return e.jsxs("div",{className:"w-full max-h-screen bg-gradient-to-r from-blue-600 to-purple-700 flex flex-col",children:[e.jsx("header",{className:"p-6  text-white text-center shadow",children:e.jsx("h1",{className:"text-3xl font-bold",children:"Constitution"})}),e.jsx("main",{className:"flex-1 p-2 overflow-y-auto",children:e.jsx("div",{className:"max-w-6xl mx-auto bg-white rounded-2xl shadow h-screen",children:e.jsx("iframe",{src:"/files/Constitution.pdf#toolbar=1&navpanes=0&scrollbar=1",title:"Constitution PDF",className:"w-full h-full rounded-lg"})})}),e.jsx("footer",{className:"p-6 bg-blue-700 flex justify-center",children:e.jsx(j,{to:"/",className:"px-6 py-2 bg-white text-blue-700 rounded-lg hover:bg-blue-700 transition",children:"Go to Home"})})]})}function ns(){const r=[{src:"/gallery/event1.jpg",alt:"Community clean-up drive",caption:"Members participating in a community clean-up drive"},{src:"/gallery/event2.jpg",alt:"Financial literacy workshop",caption:"Financial literacy workshop for members"},{src:"/gallery/event3.jpg",alt:"Tree planting initiative",caption:"Tree planting initiative for a greener Colombo"},{src:"/gallery/event4.jpg",alt:"Personal development seminar",caption:"Personal development seminar for youth members"},{src:"/gallery/event5.jpg",alt:"Health awareness camp",caption:"Health awareness camp in partnership with local clinics"},{src:"/gallery/event6.jpg",alt:"Cultural event",caption:"Members showcasing local arts & culture"}],[n,a]=t.useState(null);return e.jsxs(t.Fragment,{children:[e.jsxs("section",{className:"relative w-full h-[40vh] bg-indigo-700 flex items-center justify-center overflow-hidden",children:[e.jsx("img",{src:"/login-image3.jpg",alt:"Gallery Banner",className:"absolute inset-0 w-full h-full object-cover opacity-50 mix-blend-overlay"}),e.jsx("h1",{className:"relative text-4xl md:text-5xl font-extrabold text-white drop-shadow-lg text-center",children:"Our Gallery"})]}),e.jsxs("section",{className:"max-w-6xl mx-auto px-6 py-16",children:[e.jsx("h2",{className:"text-3xl font-bold text-center mb-10",children:"Moments from Our Initiatives"}),e.jsx("div",{className:"grid gap-6 sm:grid-cols-2 md:grid-cols-3",children:r.map((i,s)=>e.jsxs(de.div,{className:"relative cursor-pointer overflow-hidden rounded-xl shadow-lg",whileHover:{scale:1.05},onClick:()=>a(i),children:[e.jsx("img",{src:i.src,alt:i.alt,className:"w-full h-64 object-cover"}),e.jsx("div",{className:"absolute bottom-0 left-0 right-0 bg-black bg-opacity-40 text-white p-3 text-sm",children:i.caption})]},s))})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-70 flex items-center justify-center z-50 p-4",onClick:()=>a(null),children:e.jsxs("div",{className:"relative max-w-3xl w-full",children:[e.jsx("img",{src:n.src,alt:n.alt,className:"w-full max-h-[80vh] object-contain rounded-lg"}),e.jsx("p",{className:"text-white text-center mt-4",children:n.caption})]})})]})}function os(){return e.jsxs("div",{className:"w-full min-h-screen flex flex-col",children:[e.jsx(rs,{}),e.jsx("main",{className:"w-full flex-grow flex flex-col items-center px-4 py-6",children:e.jsx(Be,{})})]})}function cs(){return e.jsx(Le,{children:e.jsxs(q,{path:"*",element:e.jsx(os,{}),children:[e.jsx(q,{index:!0,element:e.jsx(ts,{})}),e.jsx(q,{path:"gallery",element:e.jsx(ns,{})}),e.jsx(q,{path:"about",element:e.jsx(es,{})}),e.jsx(q,{path:"contact",element:e.jsx(He,{})}),e.jsx(q,{path:"constitution",element:e.jsx(ls,{})}),e.jsx(q,{path:"*",element:e.jsx(Ae,{})})]})})}function is(){const[r,n]=t.useState(""),[a,i]=t.useState(""),s=ee(),l=_e({onSuccess:async({access_token:o})=>{var b,x;try{const p=await y.post("http://localhost:3000/api/user/login-google",{accessToken:o});m.success("Login Successful"),localStorage.setItem("token",p.data.token),p.data.role==="admin"?s("/admin/members"):s("/")}catch(p){m.error(((x=(b=p==null?void 0:p.response)==null?void 0:b.data)==null?void 0:x.message)||"Google login failed")}},onError:()=>m.error("Google login failed")});async function d(){var o,b;if(!r||!a){m.error("Email and password are required");return}try{const x=await y.post("http://localhost:3000/api/user/login",{email:r,password:a});m.success("Login Success"),localStorage.setItem("token",x.data.token),x.data.role==="admin"?s("/admin/members"):s("/")}catch(x){m.error(((b=(o=x==null?void 0:x.response)==null?void 0:o.data)==null?void 0:b.message)||"Login failed")}}return e.jsxs("div",{className:"w-full h-screen bg-[url('/login-background.jpg')] bg-cover bg-center flex justify-center items-center gap-12",children:[e.jsx("div",{className:"w-[600px] h-[500px] rounded-2xl shadow-2xl overflow-hidden hidden md:block",children:e.jsx("img",{src:"/login-image3.jpg",alt:"Login Visual",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"w-[400px] h-[500px] py-10 px-5 backdrop-blur-md bg-white/30 rounded-2xl shadow-2xl flex flex-col justify-center items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-purple-600 mb-8",children:"Login to Your Account"}),e.jsx("input",{type:"email",placeholder:"Email",value:r,onChange:o=>n(o.target.value),className:"w-[300px] h-[40px] px-3 rounded-md border border-white bg-green-50 mb-5 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("input",{type:"password",placeholder:"Password",value:a,onChange:o=>i(o.target.value),className:"w-[300px] h-[40px] px-3 rounded-md border border-white bg-green-50 mb-5 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("button",{onClick:d,className:"w-[300px] h-[40px] text-white font-semibold bg-purple-600 hover:bg-purple-700 active:bg-purple-800 rounded-md mb-4 transition",children:"Login"}),e.jsxs("button",{onClick:l,className:"w-[300px] h-[40px] flex items-center justify-center gap-3 text-purple-600 font-semibold border border-purple-600 hover:text-white hover:bg-purple-700 active:bg-purple-800 rounded-md transition",children:[e.jsx(qe,{className:"text-2xl"}),e.jsx("span",{children:"Login with Google"})]}),e.jsxs("div",{className:"flex justify-between items-center text-blue-800 gap-10 pt-4 pb-6",children:[e.jsx(j,{to:"/register",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"Register New Account"}),e.jsx(j,{to:"/forget",className:"text-sm text-blue-600 hover:text-blue-800 hover:underline",children:"Forgot Password?"})]})]})]})}function ds(){const[r,n]=t.useState(""),[a,i]=t.useState(""),[s,l]=t.useState(""),[d,o]=t.useState(""),b=ee();async function x(){var c,S;if(!r||!a||!s||!d){m.error("Please fill in all fields");return}try{const g=await y.post("http://localhost:3000/api/user/",{firstname:r,lastname:a,email:s,password:d});m.success("Registration Successful"),localStorage.setItem("token",g.data.token),b("/login")}catch(g){m.error(((S=(c=g==null?void 0:g.response)==null?void 0:c.data)==null?void 0:S.message)||"Registration failed")}}const p=_e({onSuccess:async c=>{var S,g;try{const N=c.access_token,u=await y.post("http://localhost:3000/api/user/create-google",{accessToken:N});m.success("Register Successful"),localStorage.setItem("token",u.data.token),u.data.role==="admin"?b("/admin/"):b("/")}catch(N){m.error(((g=(S=N==null?void 0:N.response)==null?void 0:S.data)==null?void 0:g.message)||"Google register failed")}},onError:()=>{m.error("Google register failed")}});return e.jsxs("div",{className:"w-full h-screen bg-[url('/login-background.jpg')] bg-cover bg-center flex justify-center gap-12 items-center",children:[e.jsx("div",{className:"w-[600px] h-[500px] rounded-2xl shadow-2xl overflow-hidden",children:e.jsx("img",{src:"/login-image3.jpg",alt:"Register Visual",className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"w-[400px] h-[500px] py-10 px-5 backdrop-blur-md bg-white/30 rounded-2xl shadow-2xl flex flex-col justify-center items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-purple-600 mb-8",children:"Register New Account"}),e.jsx("input",{type:"text",placeholder:"First Name",value:r,onChange:c=>n(c.target.value),className:"w-[300px] h-[40px] px-3 mb-4 rounded-md border border-white bg-green-50 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("input",{type:"text",placeholder:"Last Name",value:a,onChange:c=>i(c.target.value),className:"w-[300px] h-[40px] px-3 mb-4 rounded-md border border-white bg-green-50 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("input",{type:"email",placeholder:"Email",value:s,onChange:c=>l(c.target.value),className:"w-[300px] h-[40px] px-3 mb-4 rounded-md border border-white bg-green-50 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("input",{type:"password",placeholder:"Password",value:d,onChange:c=>o(c.target.value),className:"w-[300px] h-[40px] px-3 mb-4 rounded-md border border-white bg-green-50 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("button",{onClick:x,className:"w-[300px] h-[40px] mb-4 text-white font-semibold bg-purple-600 hover:bg-purple-700 active:bg-purple-800 rounded-md transition",children:"Register"}),e.jsx("p",{className:"mb-4 text-sm text-gray-700",children:"or"}),e.jsxs("button",{onClick:p,className:"w-[300px] h-[40px] flex items-center justify-center gap-3 text-purple-600 font-semibold border border-purple-600 hover:text-white hover:bg-purple-700 active:bg-purple-800 rounded-md transition",children:[e.jsx(qe,{className:"text-2xl"}),e.jsx("span",{children:"Register with Google"})]})]})]})}function xs(){const[r,n]=t.useState(!1),[a,i]=t.useState(""),[s,l]=t.useState(""),[d,o]=t.useState(""),[b,x]=t.useState(""),p=ee();function c(){if(!a){m.error("Please enter your email");return}y.post("http://localhost:3000/api/user/send-OTP",{email:a}).then(N=>{n(!0),m.success("OTP sent to your email. Check your inbox."),console.log(N.data)}).catch(N=>{m.error("Email not found")})}function S(){if(d!==b){m.error("Passwords do not match");return}const N=parseInt(s.trim(),10);if(isNaN(N)){m.error("Please enter a valid numeric OTP");return}y.post("http://localhost:3000/api/user/reset-password",{email:a,otp:N,newPassword:d}).then(u=>{m.success("Password reset successfully"),console.log(u.data),p("/login")}).catch(u=>{var w,v;console.error(u),m.error(((v=(w=u==null?void 0:u.response)==null?void 0:w.data)==null?void 0:v.message)||"Invalid OTP")})}function g(){l(""),o(""),x(""),n(!1)}return e.jsxs("div",{className:"w-full h-screen bg-[url('/login-background.jpg')] bg-cover bg-center flex justify-center items-center gap-12",children:[e.jsx("div",{className:"w-[600px] h-[500px] rounded-2xl shadow-2xl",children:e.jsx("img",{src:"/login-image3.jpg",alt:"Login Visual",className:"w-full h-full object-cover rounded-2xl"})}),r?e.jsxs("div",{className:"w-[400px] h-[500px] py-10 px-5 backdrop-blur-md bg-white/30 rounded-2xl shadow-2xl flex flex-col justify-center items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-purple-600 mb-8",children:"Reset Password"}),e.jsx("input",{type:"text",placeholder:"Enter OTP",value:s,onChange:N=>l(N.target.value),className:"w-[300px] h-[40px] px-3 mb-4 rounded-md border border-white bg-green-50 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("input",{type:"password",placeholder:"New Password",value:d,onChange:N=>o(N.target.value),className:"w-[300px] h-[40px] px-3 mb-4 rounded-md border border-white bg-green-50 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("input",{type:"password",placeholder:"Confirm New Password",value:b,onChange:N=>x(N.target.value),className:"w-[300px] h-[40px] px-3 mb-4 rounded-md border border-white bg-green-50 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("button",{onClick:S,className:"w-[300px] h-[40px] text-white font-semibold bg-purple-600 hover:bg-purple-700 active:bg-purple-800 rounded-md mb-4 transition",children:"Reset Password"}),e.jsx("button",{onClick:g,className:"w-[300px] h-[40px] flex items-center justify-center text-purple-600 font-semibold border border-purple-600 hover:text-white hover:bg-purple-700 active:bg-purple-800 rounded-md transition",children:"Resend OTP"})]}):e.jsxs("div",{className:"w-[400px] h-[500px] py-10 px-5 backdrop-blur-md bg-white/30 rounded-2xl shadow-2xl flex flex-col justify-center items-center",children:[e.jsx("h2",{className:"text-2xl font-semibold text-purple-600 mb-8",children:"Forgot Password"}),e.jsx("input",{type:"email",placeholder:"Enter your email",value:a,onChange:N=>i(N.target.value),className:"w-[300px] h-[40px] px-3 mb-6 rounded-md border border-white bg-green-50 focus:outline-none focus:ring-2 focus:ring-purple-400"}),e.jsx("button",{onClick:c,className:"w-[300px] h-[40px] text-white font-semibold bg-purple-600 hover:bg-purple-700 active:bg-purple-800 rounded-md transition",children:"Send OTP"})]})]})}function ms(){return e.jsx(ft,{clientId:"1033564119689-va316rn8puf27vikpjmcl1v09qptfapl.apps.googleusercontent.com",children:e.jsxs(bt,{children:[e.jsx(jt,{position:"top-right"}),e.jsxs(Le,{children:[e.jsx(q,{path:"/login",element:e.jsx(is,{})}),e.jsx(q,{path:"/register",element:e.jsx(ds,{})}),e.jsx(q,{path:"/forget",element:e.jsx(xs,{})}),e.jsx(q,{path:"/admin/*",element:e.jsx(Lt,{})}),e.jsx(q,{path:"/control/*",element:e.jsx(as,{})}),e.jsx(q,{path:"*",element:e.jsx(cs,{})})]})]})})}yt.createRoot(document.getElementById("root")).render(e.jsx(t.StrictMode,{children:e.jsx(ms,{})}));
